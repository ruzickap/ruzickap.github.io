<!doctype html><html lang="en" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="IPA (CentOS7) integration with Active Directory (W2K8)" /><meta name="author" content="Petr Ruzicka" /><meta property="og:locale" content="en" /><meta name="description" content="IPA (CentOS7) integration with Active Directory (W2K8)" /><meta property="og:description" content="IPA (CentOS7) integration with Active Directory (W2K8)" /><link rel="canonical" href="https://ruzickap.github.io/posts/ipa-centos7-integration-with-active-directory-w2k8/" /><meta property="og:url" content="https://ruzickap.github.io/posts/ipa-centos7-integration-with-active-directory-w2k8/" /><meta property="og:site_name" content="Petr’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2015-07-21T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="IPA (CentOS7) integration with Active Directory (W2K8)" /><meta name="twitter:site" content="@Ruzicka_Petr" /><meta name="twitter:creator" content="@Ruzicka_Petr" /><meta name="google-site-verification" content="4ugGShJoiB9veoPwFcMsMjzk-1BYbi5ozcSnovkBWtA" /><meta name="msvalidate.01" content="592AB158E3F9EF887F8DC8E69A2FF754" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Petr Ruzicka","url":"https://petr.ruzicka.dev"},"dateModified":"2026-01-17T19:48:44+01:00","datePublished":"2015-07-21T00:00:00+02:00","description":"IPA (CentOS7) integration with Active Directory (W2K8)","headline":"IPA (CentOS7) integration with Active Directory (W2K8)","mainEntityOfPage":{"@type":"WebPage","@id":"https://ruzickap.github.io/posts/ipa-centos7-integration-with-active-directory-w2k8/"},"url":"https://ruzickap.github.io/posts/ipa-centos7-integration-with-active-directory-w2k8/"}</script><title>IPA (CentOS7) integration with Active Directory (W2K8) | Petr's Blog</title><link rel="icon" type="image/png" href="/assets/img/favicons/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/svg+xml" href="/assets/img/favicons/favicon.svg"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.36.4/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.18/dayjs.min.js,npm/dayjs@1.11.18/locale/en.js,npm/dayjs@1.11.18/plugin/relativeTime.js,npm/dayjs@1.11.18/plugin/localizedFormat.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> document.addEventListener('DOMContentLoaded', () => { const pv = document.getElementById('pageviews'); if (pv !== null) { const uri = location.pathname.replace(/\/$/, ''); const url = `https://ruzickap-github-io.goatcounter.com/counter/${encodeURIComponent(uri)}.json`; fetch(url) .then((response) => response.json()) .then((data) => { const count = data.count.replace(/\D/g, ''); pv.innerText = new Intl.NumberFormat().format(count); }) .catch((error) => { pv.innerText = '1'; }); } }); </script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-64WRCWDZM8"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-64WRCWDZM8'); }); </script> <script async src="https://gc.zgo.at/count.js" data-goatcounter="https://ruzickap-github-io.goatcounter.com/count" ></script> <script defer src="https://cloud.umami.is/script.js" data-website-id="380ea41a-7d5f-4423-8e13-03151bde195f" ></script> <script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token": "ad8c64404e1e41dba184019564cf11bb"}' ></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="https://0.gravatar.com/avatar/5484c0fd9f98e2ffd9212b158931bf4b?s=200" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Petr's Blog</a><p class="site-subtitle fst-italic mb-0">DevOps • GitOps • K8s</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/projects/" class="nav-link"> <i class="fa-fw fas fa-project-diagram"></i> <span>PROJECTS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/ruzickap" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['petr.ruzicka','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://petr.ruzicka.dev" aria-label="homepage" target="_blank" rel="noopener noreferrer" > <i class="fas fa-home"></i> </a> <a href="https://mastodon.social/@petr_ruzicka" aria-label="mastodon" target="_blank" rel="noopener noreferrer me" > <i class="fab fa-mastodon"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>IPA (CentOS7) integration with Active Directory (W2K8)</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="false"><header><h1 data-toc-skip>IPA (CentOS7) integration with Active Directory (W2K8)</h1><p class="post-desc fw-light mb-4">IPA (CentOS7) integration with Active Directory (W2K8)</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1437429600" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jul 21, 2015 </time> </span> <span> Updated <time data-ts="1768675724" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jan 17, 2026 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://petr.ruzicka.dev">Petr Ruzicka</a> </em> </span><div> <span> <em id="pageviews"> <i class="fas fa-spinner fa-spin small"></i> </em> views </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="712 words" > <em>3 min</em> read</span></div></div></div></header><div class="content"><blockquote class="prompt-info"><p>Original post from <a href="https://linux.xvx.cz/2015/07/ipa-centos7-integration-with-active.html">linux.xvx.cz</a></p></blockquote><p>I have been working with IPA in the past few months and I would like to share my notes about the IPA and AD integration.</p><p>Network diagram:</p><p><a href="/assets/img/posts/2015/2015-07-21-ipa-centos7-integration-with-active-directory-w2k8/ipa.avif" class="popup img-link shimmer"><img src="/assets/img/posts/2015/2015-07-21-ipa-centos7-integration-with-active-directory-w2k8/ipa.avif" alt="IPA and Active Directory integration network diagram" width="500" loading="lazy"></a></p><p>I created the trust between the Active Directory and IPA server. There is one windows client connected to the AD and one CentOS7 client connected to the IPA. Both clients are “registered” into the AD/IPA.</p><p>Instead of describing the whole installation - I decided to record a video containing the AD/IPA installation, client registration and Firefox/PuTTY/WinSCP Kerberos/GSSAPI configuration.</p><iframe class="embed-video" loading="lazy" src="https://www.youtube.com/embed/n_Jk-9ibFqE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><p>The commands used in the video can be found below:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="nx">Change</span><span class="w"> </span><span class="nx">TimeZone</span><span class="w">
</span><span class="n">tzutil</span><span class="w"> </span><span class="nx">/s</span><span class="w"> </span><span class="s2">"Central Europe Standard Time"</span><span class="w">

</span><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="nx">Configure</span><span class="w"> </span><span class="nx">NTP</span><span class="w"> </span><span class="nx">server</span><span class="w">
</span><span class="n">net</span><span class="w"> </span><span class="nx">start</span><span class="w"> </span><span class="nx">w32time</span><span class="w">
</span><span class="n">w32tm</span><span class="w"> </span><span class="nx">/config</span><span class="w"> </span><span class="nx">/manualpeerlist:</span><span class="s2">"ntp.cesnet.cz"</span><span class="w"> </span><span class="nx">/reliable:yes</span><span class="w"> </span><span class="nx">/update</span><span class="w">

</span><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="nx">Change</span><span class="w"> </span><span class="nx">hostname</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-NoProfile</span><span class="w"> </span><span class="nt">-command</span><span class="w"> </span><span class="s2">"</span><span class="nv">$sysInfo</span><span class="s2"> = Get-WmiObject -Class Win32_ComputerSystem; </span><span class="nv">$sysInfo</span><span class="s2">.Rename('ad');"</span><span class="w">

</span><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="nx">Disable</span><span class="w"> </span><span class="nx">firewall</span><span class="w">
</span><span class="n">netsh</span><span class="w"> </span><span class="nx">advfirewall</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">allprofiles</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="nx">off</span><span class="w">

</span><span class="n">DCPROMO</span><span class="w">

</span><span class="c"># "Create a new domain in a new forest"</span><span class="w">
</span><span class="c"># example.com</span><span class="w">
</span><span class="c"># Windows Server 2008 R2</span><span class="w">
</span><span class="c"># admin123</span><span class="w">
</span><span class="c"># Reboot on completion</span><span class="w">

</span><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="s2">"Ensure the IPA can be reached properly"</span><span class="w">
</span><span class="n">dnscmd</span><span class="w"> </span><span class="nx">127.0.0.1</span><span class="w"> </span><span class="nx">/RecordAdd</span><span class="w"> </span><span class="nx">example.com</span><span class="w"> </span><span class="nx">ipa.ec</span><span class="w"> </span><span class="nx">A</span><span class="w"> </span><span class="nx">192.168.122.226</span><span class="w">
</span><span class="n">dnscmd</span><span class="w"> </span><span class="nx">127.0.0.1</span><span class="w"> </span><span class="nx">/RecordAdd</span><span class="w"> </span><span class="nx">example.com</span><span class="w"> </span><span class="nx">ec</span><span class="w"> </span><span class="nx">NS</span><span class="w"> </span><span class="nx">ipa.ec.example.com</span><span class="w">
</span><span class="n">dnscmd</span><span class="w"> </span><span class="nx">127.0.0.1</span><span class="w"> </span><span class="nx">/ClearCache</span><span class="w">

</span><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="s2">"Create test users"</span><span class="w">
</span><span class="n">dsadd</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">CN</span><span class="o">=</span><span class="n">testuser</span><span class="p">,</span><span class="nx">CN</span><span class="o">=</span><span class="n">Users</span><span class="p">,</span><span class="nx">DC</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="nx">DC</span><span class="o">=</span><span class="n">com</span><span class="w"> </span><span class="nt">-samid</span><span class="w"> </span><span class="nx">testuser</span><span class="w"> </span><span class="nt">-pwd</span><span class="w"> </span><span class="nx">Admintest123</span><span class="w"> </span><span class="nt">-fn</span><span class="w"> </span><span class="nx">Petr</span><span class="w"> </span><span class="nt">-ln</span><span class="w"> </span><span class="nx">Ruzicka</span><span class="w"> </span><span class="nt">-display</span><span class="w"> </span><span class="s2">"Petr Ruzicka"</span><span class="w"> </span><span class="nt">-email</span><span class="w"> </span><span class="nx">petr.ruzicka</span><span class="err">@</span><span class="nx">example.com</span><span class="w"> </span><span class="nt">-desc</span><span class="w"> </span><span class="s2">"Petr's test user"</span><span class="w"> </span><span class="nt">-pwdneverexpires</span><span class="w"> </span><span class="nx">yes</span><span class="w"> </span><span class="nt">-disabled</span><span class="w"> </span><span class="nx">no</span><span class="w">
</span><span class="n">dsadd</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">CN</span><span class="o">=</span><span class="n">testuser2</span><span class="p">,</span><span class="nx">CN</span><span class="o">=</span><span class="n">Users</span><span class="p">,</span><span class="nx">DC</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="nx">DC</span><span class="o">=</span><span class="n">com</span><span class="w"> </span><span class="nt">-samid</span><span class="w"> </span><span class="nx">testuser2</span><span class="w"> </span><span class="nt">-pwd</span><span class="w"> </span><span class="nx">Admintest123</span><span class="w"> </span><span class="nt">-fn</span><span class="w"> </span><span class="nx">Petr</span><span class="w"> </span><span class="nt">-ln</span><span class="w"> </span><span class="nx">Ruzicka2</span><span class="w"> </span><span class="nt">-display</span><span class="w"> </span><span class="s2">"Petr Ruzicka2"</span><span class="w"> </span><span class="nt">-email</span><span class="w"> </span><span class="nx">petr.ruzicka2</span><span class="err">@</span><span class="nx">example.com</span><span class="w"> </span><span class="nt">-desc</span><span class="w"> </span><span class="s2">"Petr's test user"</span><span class="w"> </span><span class="nt">-pwdneverexpires</span><span class="w"> </span><span class="nx">yes</span><span class="w"> </span><span class="nt">-disabled</span><span class="w"> </span><span class="nx">no</span><span class="w">

</span><span class="c">#It's handy to configure Delegation to enable Kerbetos Ticket forwarding for the windows clients:</span><span class="w">
</span><span class="c">#https://technet.microsoft.com/en-us/library/ee675779.aspx</span><span class="w">

</span><span class="c">#Check trudted domains:</span><span class="w">
</span><span class="c">#https://support.microsoft.com/en-us/kb/228477</span><span class="w">
</span></pre></table></code></div></div><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="nx">Change</span><span class="w"> </span><span class="nx">DNS</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">AD</span><span class="w"> </span><span class="nx">server</span><span class="w">
</span><span class="n">netsh</span><span class="w"> </span><span class="nx">interface</span><span class="w"> </span><span class="nx">ipv4</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">dnsserver</span><span class="w"> </span><span class="s2">"Local Area Connection"</span><span class="w"> </span><span class="nx">address</span><span class="o">=</span><span class="mf">192.168</span><span class="o">.</span><span class="nf">122</span><span class="o">.</span><span class="nf">247</span><span class="w"> </span><span class="n">index</span><span class="o">=</span><span class="mi">1</span><span class="w">

</span><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="nx">Change</span><span class="w"> </span><span class="nx">TimeZone</span><span class="w">
</span><span class="n">tzutil</span><span class="w"> </span><span class="nx">/s</span><span class="w"> </span><span class="s2">"Central Europe Standard Time"</span><span class="w">

</span><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="nx">Configure</span><span class="w"> </span><span class="nx">NTP</span><span class="w"> </span><span class="nx">server</span><span class="w">
</span><span class="n">net</span><span class="w"> </span><span class="nx">start</span><span class="w"> </span><span class="nx">w32time</span><span class="w">
</span><span class="n">w32tm</span><span class="w"> </span><span class="nx">/config</span><span class="w"> </span><span class="nx">/manualpeerlist:</span><span class="s2">"ntp.cesnet.cz"</span><span class="w"> </span><span class="nx">/reliable:yes</span><span class="w"> </span><span class="nx">/update</span><span class="w">

</span><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="nx">Disable</span><span class="w"> </span><span class="nx">firewall</span><span class="w">
</span><span class="n">netsh</span><span class="w"> </span><span class="nx">advfirewall</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">allprofiles</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="nx">off</span><span class="w">

</span><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="nx">Change</span><span class="w"> </span><span class="nx">hostname</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-NoProfile</span><span class="w"> </span><span class="nt">-command</span><span class="w"> </span><span class="s2">"</span><span class="nv">$sysInfo</span><span class="s2"> = Get-WmiObject -Class Win32_ComputerSystem; </span><span class="nv">$sysInfo</span><span class="s2">.Rename('win-client');"</span><span class="w">

</span><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="nx">Join</span><span class="w"> </span><span class="nx">AD</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-Command</span><span class="w"> </span><span class="s2">"</span><span class="nv">$domain</span><span class="s2"> = 'example.com'; </span><span class="nv">$password</span><span class="s2"> = 'admin123' | ConvertTo-SecureString -asPlainText -Force; </span><span class="nv">$username</span><span class="s2"> = \"</span><span class="nv">$domain</span><span class="nx">\Administrator\</span><span class="s2">"; </span><span class="nv">$credential</span><span class="s2"> = New-Object System.Management.Automation.PSCredential(</span><span class="nv">$username</span><span class="s2">,</span><span class="nv">$password</span><span class="s2">); Add-Computer -DomainName </span><span class="nv">$domain</span><span class="s2"> -Credential </span><span class="nv">$credential</span><span class="s2">"</span><span class="w">

</span><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="nx">Reboot...</span><span class="w">
</span><span class="n">shutdown</span><span class="w"> </span><span class="nx">/r</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">0</span><span class="w">
</span></pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s2">"Turn OFF Firewall"</span>
chkconfig firewalld off
service firewalld stop

<span class="nb">echo</span> <span class="s2">"192.168.122.226 ipa.ec.example.com ipa"</span> <span class="o">&gt;&gt;</span> /etc/hosts

<span class="nb">echo</span> <span class="s2">"Change DNS server to 192.168.122.247 (ad.example.com)"</span>
<span class="nb">cat</span> <span class="o">&gt;&gt;</span> /etc/dhcp/dhclient-eth0.conf <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh">

supersede domain-name-servers 192.168.122.247;
supersede domain-search "ec.example.com";
</span><span class="no">EOF
</span>service network restart

<span class="nb">echo</span> <span class="s2">"Install IPA packages"</span>
yum <span class="nb">install</span> <span class="nt">-y</span> ipa-server-trust-ad <span class="nb">bind </span>bind-dyndb-ldap

<span class="nb">echo</span> <span class="s2">"Install+Configure IPA"</span>
ipa-server-install <span class="nt">--realm</span><span class="o">=</span>EC.EXAMPLE.COM <span class="nt">--domain</span><span class="o">=</span>ec.example.com <span class="nt">--ds-password</span><span class="o">=</span>admin123 <span class="nt">--admin-password</span><span class="o">=</span>admin123 <span class="nt">--mkhomedir</span> <span class="nt">--ssh-trust-dns</span> <span class="nt">--setup-dns</span> <span class="nt">--unattended</span> <span class="nt">--forwarder</span><span class="o">=</span>192.168.122.247 <span class="nt">--no-host-dns</span>

<span class="nb">echo</span> <span class="s2">"Configure IPA server for cross-realm trusts"</span>
ipa-adtrust-install <span class="nt">--admin-password</span><span class="o">=</span>admin123 <span class="nt">--netbios-name</span><span class="o">=</span>EC <span class="nt">--add-sids</span> <span class="nt">--unattended</span>

<span class="nb">echo</span> <span class="s2">"Establish and verify cross-realm trust - Add trust with AD domain"</span>
<span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"admin123</span><span class="se">\n</span><span class="s2">"</span> | ipa trust-add <span class="nt">--type</span><span class="o">=</span>ad example.com <span class="nt">--admin</span> Administrator <span class="nt">--password</span>

<span class="nb">echo</span> <span class="s2">"Check trusted domain"</span>
ipa trustdomain-find example.com

<span class="nb">echo</span> <span class="s2">"Add new server"</span>
ipa host-add centos7-client.ec.example.com <span class="nt">--password</span><span class="o">=</span>secret <span class="nt">--ip-address</span><span class="o">=</span>192.168.122.46 <span class="nt">--os</span><span class="o">=</span><span class="s2">"CentOS 7"</span> <span class="nt">--platform</span><span class="o">=</span><span class="s2">"VMware"</span> <span class="nt">--location</span><span class="o">=</span><span class="s2">"My lab"</span> <span class="nt">--locality</span><span class="o">=</span><span class="s2">"Brno"</span> <span class="nt">--desc</span><span class="o">=</span><span class="s2">"Test server"</span>

<span class="c">#Enable kerberos in Firefox</span>
<span class="c"># about:config -&gt; network.negotiate-auth.trusted-uris -&gt; .example.com</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="c"># Turn OFF Firewall</span>
chkconfig firewalld off
service firewalld stop

<span class="nb">echo</span> <span class="s2">"192.168.122.46 centos7-client.ec.example.com centos7-client"</span> <span class="o">&gt;&gt;</span> /etc/hosts

<span class="c"># Change DNS server to 192.168.122.247 (ad.example.com)</span>
<span class="nb">cat</span> <span class="o">&gt;&gt;</span> /etc/dhcp/dhclient-eth0.conf <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh">

supersede domain-name-servers 192.168.122.247;
supersede domain-search "ec.example.com";
</span><span class="no">EOF
</span>service network restart

yum <span class="nb">install</span> <span class="nt">-y</span> ipa-client

<span class="c"># Register to IPA (there is automatic discovery of IPA IP via DNS)</span>
ipa-client-install <span class="nt">-w</span> secret <span class="nt">--mkhomedir</span>

<span class="c">#---</span>

<span class="c"># DNS checks</span>
dig SRV _ldap._tcp.example.com
dig SRV _ldap._tcp.ec.example.com

kinit admin
smbclient <span class="nt">-L</span> ipa.ec.example.com <span class="nt">-k</span>
</pre></table></code></div></div><p>Most of the commands and it’s description can be found on Google or are obvious. The video has some description, but is’t not very detailed.</p><p>Useful links:</p><ul><li><a href="https://web.archive.org/web/20150423185240/http://stef.thewalter.net/how-to-create-active-directory-domain.html">How to Create Active Directory Domain</a><li><a href="https://www.freeipa.org/page/Active_Directory_trust_setup">https://www.freeipa.org/page/Active_Directory_trust_setup</a><li><a href="https://www.freeipa.org/page/Setting_up_Active_Directory_domain_for_testing_purposes">https://www.freeipa.org/page/Setting_up_Active_Directory_domain_for_testing_purposes</a><li><a href="https://www.certdepot.net/wp-content/uploads/2015/07/Summit_IdM_Lab_User_Guide_2015.pdf">https://www.certdepot.net/wp-content/uploads/2015/07/Summit_IdM_Lab_User_Guide_2015.pdf</a></ul><p>Enjoy :-)</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/linux/">Linux</a>, <a href="/categories/windows/">Windows</a>, <a href="/categories/linux-xvx-cz/">linux.xvx.cz</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/rhel/" class="post-tag no-text-decoration" >rhel</a> <a href="/tags/freeipa/" class="post-tag no-text-decoration" >freeipa</a> <a href="/tags/active-directory/" class="post-tag no-text-decoration" >active-directory</a> <a href="/tags/sso/" class="post-tag no-text-decoration" >sso</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=IPA%20(CentOS7)%20integration%20with%20Active%20Directory%20(W2K8)%20-%20Petr's%20Blog&url=https%3A%2F%2Fruzickap.github.io%2Fposts%2Fipa-centos7-integration-with-active-directory-w2k8%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=IPA%20(CentOS7)%20integration%20with%20Active%20Directory%20(W2K8)%20-%20Petr's%20Blog&u=https%3A%2F%2Fruzickap.github.io%2Fposts%2Fipa-centos7-integration-with-active-directory-w2k8%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fruzickap.github.io%2Fposts%2Fipa-centos7-integration-with-active-directory-w2k8%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <script defer type="module" src="https://cdn.jsdelivr.net/npm/@justinribeiro/share-to-mastodon/+esm"></script> <button class="btn text-start" data-bs-toggle="tooltip" data-bs-placement="top" title="Mastodon" aria-label="Mastodon"> <share-to-mastodon class="share-mastodon" message="IPA%20(CentOS7)%20integration%20with%20Active%20Directory%20(W2K8)%20-%20Petr's%20Blog" url="https%3A%2F%2Fruzickap.github.io%2Fposts%2Fipa-centos7-integration-with-active-directory-w2k8%2F"customInstanceList="[{&quot;label&quot;:&quot;mastodon.social&quot;,&quot;link&quot;:&quot;https://mastodon.social/&quot;},{&quot;label&quot;:&quot;mastodon.online&quot;,&quot;link&quot;:&quot;https://mastodon.online/&quot;},{&quot;label&quot;:&quot;fosstodon.org&quot;,&quot;link&quot;:&quot;https://fosstodon.org/&quot;},{&quot;label&quot;:&quot;photog.social&quot;,&quot;link&quot;:&quot;https://photog.social/&quot;}]" > <i class="fa-fw fa-brands fa-mastodon"></i> </share-to-mastodon> </button> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/installtion-f5-bigip-virtual-edition-to-rhel7/">Installation F5 BIGIP Virtual Edition to RHEL7</a><li class="text-truncate lh-lg"> <a href="/posts/detect-a-hacker-attacks-eks-vm/">Detect the hacker attacks on Amazon EKS and EC2 instances</a><li class="text-truncate lh-lg"> <a href="/posts/secure-cheap-amazon-eks-auto/">Build secure and cheap Amazon EKS Auto Mode</a><li class="text-truncate lh-lg"> <a href="/posts/eks-auto-cert-manager-velero/">Amazon EKS Auto Mode with cert-manager and Velero</a><li class="text-truncate lh-lg"> <a href="/posts/mcp-servers-k8s/">MCP Servers running on Kubernetes</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/amazon-eks/">amazon-eks</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/cert-manager/">cert-manager</a> <a class="post-tag btn btn-outline-primary" href="/tags/eksctl/">eksctl</a> <a class="post-tag btn btn-outline-primary" href="/tags/bash/">bash</a> <a class="post-tag btn btn-outline-primary" href="/tags/pxe/">pxe</a> <a class="post-tag btn btn-outline-primary" href="/tags/wifi/">wifi</a> <a class="post-tag btn btn-outline-primary" href="/tags/prometheus/">prometheus</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a></div></section></div></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/amazon-eks-grafana-stack/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1768258800" data-df="ll" > Jan 13, 2026 </time><h4 class="pt-0 my-2">Amazon EKS and Grafana stack</h4><div class="text-muted"><p>Build secure Amazon EKS cluster with Grafana stack</p></div></div></a></article><article class="col"> <a href="/posts/secure-cheap-amazon-eks-auto/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1734130800" data-df="ll" > Dec 14, 2024 </time><h4 class="pt-0 my-2">Build secure and cheap Amazon EKS Auto Mode</h4><div class="text-muted"><p>Build "cheap and secure" Amazon EKS Auto Mode with network policies, cluster encryption and logging</p></div></div></a></article><article class="col"> <a href="/posts/installtion-f5-bigip-virtual-edition-to-rhel7/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1419289200" data-df="ll" > Dec 23, 2014 </time><h4 class="pt-0 my-2">Installation F5 BIGIP Virtual Edition to RHEL7</h4><div class="text-muted"><p>Installation F5 BIGIP Virtual Edition to RHEL7</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/installtion-f5-bigip-virtual-edition-to-rhel7/" class="btn btn-outline-primary" aria-label="Older" ><p>Installation F5 BIGIP Virtual Edition to RHEL7</p></a> <a href="/posts/atom-editor-atomio/" class="btn btn-outline-primary" aria-label="Newer" ><p>Atom editor (atom.io)</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2026</time> <a href="https://twitter.com/Ruzicka_Petr">Petr Ruzicka</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.4.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/amazon-eks/">amazon-eks</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/cert-manager/">cert-manager</a> <a class="post-tag btn btn-outline-primary" href="/tags/eksctl/">eksctl</a> <a class="post-tag btn btn-outline-primary" href="/tags/bash/">bash</a> <a class="post-tag btn btn-outline-primary" href="/tags/pxe/">pxe</a> <a class="post-tag btn btn-outline-primary" href="/tags/wifi/">wifi</a> <a class="post-tag btn btn-outline-primary" href="/tags/prometheus/">prometheus</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ruzickap/ruzickap.github.io', 'data-repo-id': 'R_kgDOGkp4nQ', 'data-category': 'General', 'data-category-id': 'DIC_kwDOGkp4nc4CSdu1', 'data-mapping': 'pathname', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
