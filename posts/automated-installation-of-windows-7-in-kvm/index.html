<!doctype html><html lang="en" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Automated installation of Windows 7 in KVM" /><meta name="author" content="Petr Ruzicka" /><meta property="og:locale" content="en" /><meta name="description" content="Automated installation of Windows 7 in KVM" /><meta property="og:description" content="Automated installation of Windows 7 in KVM" /><link rel="canonical" href="https://ruzickap.github.io/posts/automated-installation-of-windows-7-in-kvm/" /><meta property="og:url" content="https://ruzickap.github.io/posts/automated-installation-of-windows-7-in-kvm/" /><meta property="og:site_name" content="Petr’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2013-11-11T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Automated installation of Windows 7 in KVM" /><meta name="twitter:site" content="@Ruzicka_Petr" /><meta name="twitter:creator" content="@Ruzicka_Petr" /><meta name="google-site-verification" content="4ugGShJoiB9veoPwFcMsMjzk-1BYbi5ozcSnovkBWtA" /><meta name="msvalidate.01" content="592AB158E3F9EF887F8DC8E69A2FF754" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Petr Ruzicka","url":"https://petr.ruzicka.dev"},"dateModified":"2026-01-17T19:48:44+01:00","datePublished":"2013-11-11T00:00:00+01:00","description":"Automated installation of Windows 7 in KVM","headline":"Automated installation of Windows 7 in KVM","mainEntityOfPage":{"@type":"WebPage","@id":"https://ruzickap.github.io/posts/automated-installation-of-windows-7-in-kvm/"},"url":"https://ruzickap.github.io/posts/automated-installation-of-windows-7-in-kvm/"}</script><title>Automated installation of Windows 7 in KVM | Petr's Blog</title><link rel="icon" type="image/png" href="/assets/img/favicons/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/svg+xml" href="/assets/img/favicons/favicon.svg"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.36.4/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.18/dayjs.min.js,npm/dayjs@1.11.18/locale/en.js,npm/dayjs@1.11.18/plugin/relativeTime.js,npm/dayjs@1.11.18/plugin/localizedFormat.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> document.addEventListener('DOMContentLoaded', () => { const pv = document.getElementById('pageviews'); if (pv !== null) { const uri = location.pathname.replace(/\/$/, ''); const url = `https://ruzickap-github-io.goatcounter.com/counter/${encodeURIComponent(uri)}.json`; fetch(url) .then((response) => response.json()) .then((data) => { const count = data.count.replace(/\D/g, ''); pv.innerText = new Intl.NumberFormat().format(count); }) .catch((error) => { pv.innerText = '1'; }); } }); </script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-64WRCWDZM8"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-64WRCWDZM8'); }); </script> <script async src="https://gc.zgo.at/count.js" data-goatcounter="https://ruzickap-github-io.goatcounter.com/count" ></script> <script defer src="https://cloud.umami.is/script.js" data-website-id="380ea41a-7d5f-4423-8e13-03151bde195f" ></script> <script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token": "ad8c64404e1e41dba184019564cf11bb"}' ></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="https://0.gravatar.com/avatar/5484c0fd9f98e2ffd9212b158931bf4b?s=200" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Petr's Blog</a><p class="site-subtitle fst-italic mb-0">DevOps • GitOps • K8s</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/projects/" class="nav-link"> <i class="fa-fw fas fa-project-diagram"></i> <span>PROJECTS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/ruzickap" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['petr.ruzicka','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://petr.ruzicka.dev" aria-label="homepage" target="_blank" rel="noopener noreferrer" > <i class="fas fa-home"></i> </a> <a href="https://mastodon.social/@petr_ruzicka" aria-label="mastodon" target="_blank" rel="noopener noreferrer me" > <i class="fab fa-mastodon"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Automated installation of Windows 7 in KVM</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="false"><header><h1 data-toc-skip>Automated installation of Windows 7 in KVM</h1><p class="post-desc fw-light mb-4">Automated installation of Windows 7 in KVM</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1384124400" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Nov 11, 2013 </time> </span> <span> Updated <time data-ts="1768675724" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jan 17, 2026 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://petr.ruzicka.dev">Petr Ruzicka</a> </em> </span><div> <span> <em id="pageviews"> <i class="fas fa-spinner fa-spin small"></i> </em> views </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1638 words" > <em>9 min</em> read</span></div></div></div></header><div class="content"><blockquote class="prompt-info"><p>Original post from <a href="https://linux.xvx.cz/2013/11/automated-installation-of-windows-7-in.html">linux.xvx.cz</a></p></blockquote><p>Sometimes I need to test/work with Windows 7 in my <a href="https://libvirt.org/">libvirt</a>/<a href="https://www.linux-kvm.org/">KVM</a> virtualization. Because the testing can be destructive I decided to automate it as much as possible. As a Linux user there are not many options to modify an ISO image and create a fully unattended installation, because I need the “windows only” tools for that. I also don’t want to use unattended configs shared by SAMBA, because it looks too complex for one VM.</p><p>Anyway here is the description of the solution for how I’m “fighting” with the automated Windows installation in the <a href="https://virt-manager.org/">Virtual Machine manager</a>.</p><p>Here are the screenshots from the VirtManager:</p><p><a href="/assets/img/posts/2013/2013-11-11-automated-installation-of-windows-7-in-kvm/win02.avif" class="popup img-link shimmer"><img src="/assets/img/posts/2013/2013-11-11-automated-installation-of-windows-7-in-kvm/win02.avif" alt="Virtual Machine Manager VirtIO disk configuration" loading="lazy"></a></p><p><a href="/assets/img/posts/2013/2013-11-11-automated-installation-of-windows-7-in-kvm/win01.avif" class="popup img-link shimmer"><img src="/assets/img/posts/2013/2013-11-11-automated-installation-of-windows-7-in-kvm/win01.avif" alt="Virtual Machine Manager Windows 7 VM overview" loading="lazy"></a></p><p>As you can see above I decided to use <a href="https://www.linux-kvm.org/page/Virtio">VirtIO</a> for disk access to get the best performance. In such a case I’ll need the <a href="https://www.linux-kvm.org/page/WindowsGuestDrivers/Download_Drivers">Windows VirtIO Drivers</a> otherwise the disk is not going to be visible.</p><p>I decided to create my own iso image which I used as the second CD-ROM drive. This has two advantages - I can put there the VirtIO drivers and the <code class="language-plaintext highlighter-rouge">autostart.bat</code> script which needs to be executed manually after first boot.</p><p>Here is a short script to create such an ISO:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash -x</span>

<span class="nv">URL</span><span class="o">=</span><span class="s2">"http://alt.fedoraproject.org/pub/alt/virtio-win/latest/images/bin/virtio-win-0.1-65.iso"</span>
<span class="nv">ISO</span><span class="o">=</span><span class="si">$(</span><span class="nb">basename</span> <span class="s2">"</span><span class="nv">$URL</span><span class="s2">"</span><span class="si">)</span>

<span class="nb">sudo rm </span>autostart.iso
wget <span class="nt">--continue</span> <span class="s2">"</span><span class="nv">$URL</span><span class="s2">"</span>

<span class="nb">sudo </span>mount <span class="nt">-o</span> loop <span class="s2">"./</span><span class="nv">$ISO</span><span class="s2">"</span> /mnt/iso

<span class="nb">mkdir</span> <span class="nt">-v</span> <span class="nb">cd</span>
<span class="c">#32 bit</span>
<span class="nb">cp</span> <span class="nt">-v</span> /mnt/iso/win7/x86/<span class="k">*</span> <span class="s2">"</span><span class="nv">$PWD</span><span class="s2">/cd/"</span>
<span class="c">#64 bit</span>
<span class="c">#cp -v -r /mnt/iso/win7/amd64/* "$PWD/cd/"</span>

<span class="nb">cat</span> <span class="o">&gt;</span> <span class="s2">"</span><span class="nv">$PWD</span><span class="s2">/cd/autorun.bat"</span> <span class="o">&lt;&lt;</span> <span class="sh">\</span><span class="no">EOF</span><span class="sh">
:: Tested on Windows Win7

powershell -command "</span><span class="nv">$client</span><span class="sh"> = new-object System.Net.WebClient; </span><span class="nv">$client</span><span class="sh">.DownloadFile(</span><span class="se">\"</span><span class="sh">https://gist.github.com/ruzickap/7395426/raw/win7-admin.bat</span><span class="se">\"</span><span class="sh">, </span><span class="se">\"</span><span class="sh">c:</span><span class="se">\w</span><span class="sh">in7-admin.bat</span><span class="se">\"</span><span class="sh">)"
powershell -command "</span><span class="nv">$client</span><span class="sh"> = new-object System.Net.WebClient; </span><span class="nv">$client</span><span class="sh">.DownloadFile(</span><span class="se">\"</span><span class="sh">https://gist.github.com/ruzickap/7395075/raw/win7-user.bat</span><span class="se">\"</span><span class="sh">, </span><span class="se">\"</span><span class="sh">c:</span><span class="se">\w</span><span class="sh">in7-user.bat</span><span class="se">\"</span><span class="sh">)"

c:</span><span class="se">\w</span><span class="sh">in7-user.bat
</span><span class="no">EOF

</span><span class="nb">chmod </span>644 <span class="s2">"</span><span class="nv">$PWD</span><span class="s2">/cd/"</span><span class="k">*</span>
genisoimage <span class="nt">-v</span> <span class="nt">-V</span> AUTOSTART <span class="nt">-J</span> <span class="nt">-r</span> <span class="nt">-o</span> autostart.iso <span class="nb">cd</span>/<span class="k">*</span>

<span class="nb">sudo </span>umount /mnt/iso
<span class="nb">rm</span> <span class="nt">-rvf</span> <span class="s2">"</span><span class="nv">$PWD</span><span class="s2">/cd"</span>
<span class="nb">rm</span> <span class="s2">"</span><span class="nv">$ISO</span><span class="s2">"</span>
</pre></table></code></div></div><p>Another screenshot showing the second CD-ROM with the <code class="language-plaintext highlighter-rouge">autostart.iso</code>:</p><p><a href="/assets/img/posts/2013/2013-11-11-automated-installation-of-windows-7-in-kvm/win03.avif" class="popup img-link shimmer"><img src="/assets/img/posts/2013/2013-11-11-automated-installation-of-windows-7-in-kvm/win03.avif" alt="Virtual Machine Manager CD-ROM configuration with autostart.iso" loading="lazy"></a></p><p>Once the installation of the Windows 7 is completed you should run the <code class="language-plaintext highlighter-rouge">autostart.bat</code> using the “Run as administrator” option.</p><p>It will download the <a href="https://gist.github.com/ruzickap/7395426">win7-admin.bat</a> and download+run <a href="https://gist.github.com/ruzickap/7395075">win7-user.bat</a>.</p><p>You can see the content of the <a href="https://gist.github.com/ruzickap/7395075">win7-user.bat</a> here:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
</pre><td class="rouge-code"><pre><span class="p">::</span><span class="w"> </span><span class="n">Tested</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">7</span><span class="w">

</span><span class="n">echo</span><span class="w"> </span><span class="nx">on</span><span class="w">

</span><span class="n">rem</span><span class="w"> </span><span class="nx">for</span><span class="w"> </span><span class="nx">/f</span><span class="w"> </span><span class="s2">"tokens=3"</span><span class="w"> </span><span class="o">%%</span><span class="nx">i</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="p">(</span><span class="s1">'netsh interface ip show addresses "Local Area Connection" ^|findstr IP.Address'</span><span class="p">)</span><span class="w"> </span><span class="kr">do</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="nx">IP</span><span class="o">=%%</span><span class="n">i</span><span class="w">
</span><span class="nx">rem</span><span class="w"> </span><span class="nx">for</span><span class="w"> </span><span class="nx">/f</span><span class="w"> </span><span class="s2">"tokens=2 delims=. "</span><span class="w"> </span><span class="o">%%</span><span class="nx">j</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="p">(</span><span class="s1">'nslookup %IP% ^|find "Name:"'</span><span class="p">)</span><span class="w"> </span><span class="kr">do</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="nx">HOSTNAME</span><span class="o">=%%</span><span class="n">j</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Enable</span><span class="w"> </span><span class="nx">Administrator</span><span class="w">
</span><span class="n">net</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">administrator</span><span class="w"> </span><span class="nx">/active:yes</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Change</span><span class="w"> </span><span class="nx">password</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">Password</span><span class="w"> </span><span class="nx">Complexity</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">allow</span><span class="w"> </span><span class="nx">simple</span><span class="w"> </span><span class="nx">passwords</span><span class="w">
</span><span class="n">net</span><span class="w"> </span><span class="nx">accounts</span><span class="w"> </span><span class="nx">/maxpwage:unlimited</span><span class="w">
</span><span class="n">net</span><span class="w"> </span><span class="nx">accounts</span><span class="w"> </span><span class="nx">/minpwlen:0</span><span class="w">
</span><span class="n">secedit</span><span class="w"> </span><span class="nx">/export</span><span class="w"> </span><span class="nx">/cfg</span><span class="w"> </span><span class="nx">c:\password.cfg</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-command</span><span class="w"> </span><span class="s2">"</span><span class="nv">${c:\password.cfg}</span><span class="s2">=</span><span class="nv">${c:\password.cfg}</span><span class="s2"> | %% {</span><span class="bp">$_</span><span class="s2">.Replace('PasswordComplexity = 1', 'PasswordComplexity = 0')}"</span><span class="w">
</span><span class="n">secedit</span><span class="w"> </span><span class="nx">/configure</span><span class="w"> </span><span class="nx">/db</span><span class="w"> </span><span class="o">%</span><span class="nx">windir</span><span class="o">%</span><span class="nx">\security\new.sdb</span><span class="w"> </span><span class="nx">/cfg</span><span class="w"> </span><span class="nx">c:\password.cfg</span><span class="w"> </span><span class="nx">/areas</span><span class="w"> </span><span class="nx">SECURITYPOLICY</span><span class="w">
</span><span class="n">del</span><span class="w"> </span><span class="nx">c:\password.cfg</span><span class="w">
</span><span class="n">net</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">Administrator</span><span class="w"> </span><span class="nx">xxxx</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Autologin</span><span class="w">
</span><span class="n">rem</span><span class="w"> </span><span class="nx">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="nx">AutoAdminLogon</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_SZ</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="s2">"1"</span><span class="w"> </span><span class="nx">/f</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="nx">DefaultUserName</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_SZ</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="s2">"Administrator"</span><span class="w"> </span><span class="nx">/f</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="nx">DefaultPassword</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_SZ</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="s2">"xxxx"</span><span class="w"> </span><span class="nx">/f</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Enable</span><span class="w"> </span><span class="nx">Remote</span><span class="w"> </span><span class="nx">Desktop</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">ADD</span><span class="w"> </span><span class="s2">"HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="nx">fDenyTSConnections</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_DWORD</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="nx">0</span><span class="w"> </span><span class="nx">/f</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Set</span><span class="w"> </span><span class="nx">proxy</span><span class="w"> </span><span class="nx">settings</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="nx">MigrateProxy</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_DWORD</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="nx">0x1</span><span class="w"> </span><span class="nx">/f</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="nx">ProxyServer</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_SZ</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="s2">"http=proxy.example.com:3128;https=proxy.example.com:3128;ftp=proxy.example.com:3128;socks=proxy.example.com:3128;"</span><span class="w"> </span><span class="nx">/f</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="nx">ProxyOverride</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_SZ</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="err">^&lt;</span><span class="nx">local</span><span class="err">^&gt;</span><span class="p">;</span><span class="w"> </span><span class="n">/f</span><span class="w">
</span><span class="nx">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKLM\Software\Policies\Microsoft\Windows\CurrentVersion\Internet Settings"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="nx">ProxySettingsPerUser</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_DWORD</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="nx">0x0</span><span class="w"> </span><span class="nx">/f</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Creating</span><span class="w"> </span><span class="nx">bat</span><span class="w"> </span><span class="nx">script</span><span class="w"> </span><span class="nx">running</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">start</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">check</span><span class="w"> </span><span class="nx">if</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">proxy</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">available</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nx">not.</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">off</span><span class="w"> </span><span class="err">^</span><span class="w">

</span><span class="n">ping</span><span class="w"> </span><span class="nt">-n</span><span class="w"> </span><span class="nx">3</span><span class="w"> </span><span class="nx">proxy.example.com</span><span class="w"> </span><span class="err">^</span><span class="w">

</span><span class="kr">if</span><span class="w"> </span><span class="o">%%</span><span class="n">ERRORLEVEL</span><span class="o">%%</span><span class="w"> </span><span class="nx">EQU</span><span class="w"> </span><span class="nx">0</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="err">^</span><span class="w">

  </span><span class="err">@</span><span class="n">echo.</span><span class="w"> </span><span class="err">^</span><span class="w">

  </span><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="o">***</span><span class="w"> </span><span class="nx">Setting</span><span class="w"> </span><span class="nx">proxy</span><span class="w"> </span><span class="err">^</span><span class="w">

  </span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="nx">ProxyEnable</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_DWORD</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="nx">0x1</span><span class="w"> </span><span class="nx">/f</span><span class="w"> </span><span class="err">^</span><span class="w">

</span><span class="p">)</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="err">^</span><span class="w">

  </span><span class="err">@</span><span class="n">echo.</span><span class="w"> </span><span class="err">^</span><span class="w">

  </span><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="o">***</span><span class="w"> </span><span class="nx">Proxy</span><span class="w"> </span><span class="nx">disabled</span><span class="w"> </span><span class="err">^</span><span class="w">

</span><span class="p">)</span><span class="w"> </span><span class="err">^</span><span class="w">

</span><span class="err">&gt;</span><span class="w"> </span><span class="s2">"%ProgramData%\Microsoft\Windows\Start Menu\Programs\Startup\proxy.bat"</span><span class="w">

</span><span class="n">start</span><span class="w"> </span><span class="nx">/MIN</span><span class="w"> </span><span class="s2">"%ProgramData%\Microsoft\Windows\Start Menu\Programs\Startup\proxy.bat"</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Configure</span><span class="w"> </span><span class="nx">NTP</span><span class="w"> </span><span class="nx">server</span><span class="w">
</span><span class="n">w32tm</span><span class="w"> </span><span class="nx">/config</span><span class="w"> </span><span class="nx">/manualpeerlist:</span><span class="s2">"ntp.cesnet.cz"</span><span class="w"> </span><span class="nx">/reliable:yes</span><span class="w"> </span><span class="nx">/update</span><span class="w">
</span><span class="n">net</span><span class="w"> </span><span class="nx">start</span><span class="w"> </span><span class="nx">w32time</span><span class="w">
</span><span class="n">rem</span><span class="w"> </span><span class="nx">w32tm</span><span class="w"> </span><span class="nx">/resync</span><span class="w"> </span><span class="nx">/rediscover</span><span class="w">
</span><span class="n">rem</span><span class="w"> </span><span class="nx">w32tm</span><span class="w"> </span><span class="nx">/query</span><span class="w"> </span><span class="nx">/peers</span><span class="w">
</span><span class="n">rem</span><span class="w"> </span><span class="nx">w32tm</span><span class="w"> </span><span class="nx">/query</span><span class="w"> </span><span class="nx">/status</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Disable</span><span class="w"> </span><span class="nx">firewall</span><span class="w">
</span><span class="n">netsh</span><span class="w"> </span><span class="nx">advfirewall</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">allprofiles</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="nx">off</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Change</span><span class="w"> </span><span class="nx">TimeZone</span><span class="w">
</span><span class="n">tzutil</span><span class="w"> </span><span class="nx">/s</span><span class="w"> </span><span class="s2">"Central Europe Standard Time"</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Disable</span><span class="w"> </span><span class="nx">IPv6</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">hklm\system\currentcontrolset\services\tcpip6\parameters</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="nx">DisabledComponents</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_DWORD</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="nx">255</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Disable</span><span class="w"> </span><span class="nx">firewall</span><span class="w">
</span><span class="n">netsh</span><span class="w"> </span><span class="nx">advfirewall</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">allprofiles</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="nx">off</span><span class="w">


</span><span class="n">rem</span><span class="w"> </span><span class="err">@</span><span class="nx">echo.</span><span class="w">
</span><span class="n">rem</span><span class="w"> </span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="nx">change</span><span class="w">
</span><span class="n">rem</span><span class="w"> </span><span class="nx">powershell</span><span class="w"> </span><span class="nt">-command</span><span class="w"> </span><span class="s2">"</span><span class="nv">$sysInfo</span><span class="s2"> = Get-WmiObject -Class Win32_ComputerSystem; </span><span class="nv">$sysInfo</span><span class="s2">.Rename('%HOSTNAME%');"</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Run</span><span class="w"> </span><span class="nx">IE</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="nx">proxy</span><span class="w"> </span><span class="nx">settings</span><span class="w"> </span><span class="nx">working</span><span class="w"> </span><span class="nx">properly</span><span class="w"> </span><span class="p">(</span><span class="n">workaround</span><span class="w"> </span><span class="nx">for</span><span class="w"> </span><span class="nx">proxy</span><span class="w"> </span><span class="nx">settings</span><span class="p">)</span><span class="w">
</span><span class="n">start</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="s2">"%PROGRAMFILES%\Internet Explorer"</span><span class="w"> </span><span class="nx">iexplore.exe</span><span class="w"> </span><span class="nx">www.google.com</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Disable</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Update</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="nx">AUOptions</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_DWORD</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="nx">1</span><span class="w"> </span><span class="nx">/f</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="nx">AUState</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_DWORD</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="nx">7</span><span class="w"> </span><span class="nx">/f</span><span class="w">


</span><span class="n">ping</span><span class="w"> </span><span class="nt">-n</span><span class="w"> </span><span class="nx">3</span><span class="w"> </span><span class="nx">127.0.0.1</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">nul</span><span class="w">

</span><span class="n">shutdown</span><span class="w"> </span><span class="nx">/r</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">0</span><span class="w">
</span><span class="n">move</span><span class="w"> </span><span class="nx">c:\win7-user.bat</span><span class="w"> </span><span class="nx">c:\windows\temp\</span><span class="w">
</span></pre></table></code></div></div><p>After the restart you should login as Administrator (with password <code class="language-plaintext highlighter-rouge">xxxx</code>) and complete installation by running <a href="https://gist.github.com/ruzickap/7395426">win7-admin.bat</a> shown here:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
</pre><td class="rouge-code"><pre><span class="p">::</span><span class="w"> </span><span class="n">Tested</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">7</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Test</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="nx">settings</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-command</span><span class="w"> </span><span class="s2">"</span><span class="nv">$client</span><span class="s2"> = new-object System.Net.WebClient; </span><span class="nv">$client</span><span class="s2">.DownloadFile('http://www.google.com', 'c:\del')"</span><span class="w">
</span><span class="kr">if</span><span class="w"> </span><span class="o">%</span><span class="n">ERRORLEVEL</span><span class="o">%</span><span class="w"> </span><span class="nx">NEQ</span><span class="w"> </span><span class="nx">0</span><span class="w"> </span><span class="p">(</span><span class="w">
  </span><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="nx">Can</span><span class="w"> </span><span class="nx">not</span><span class="w"> </span><span class="nx">download</span><span class="w"> </span><span class="nx">files</span><span class="w"> </span><span class="nx">form</span><span class="w"> </span><span class="nx">Internet</span><span class="w"> </span><span class="o">!!!</span><span class="w">
  </span><span class="n">pause</span><span class="w">
  </span><span class="nx">exit</span><span class="w">
</span><span class="p">)</span><span class="w">
</span><span class="n">del</span><span class="w"> </span><span class="nx">c:\del</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Import</span><span class="w"> </span><span class="nx">certificates</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">skip</span><span class="w"> </span><span class="s2">"Would you like to install this device software"</span><span class="w"> </span><span class="nx">prompt</span><span class="w"> </span><span class="nx">when</span><span class="w"> </span><span class="nx">installing</span><span class="w"> </span><span class="nx">Spice</span><span class="w"> </span><span class="nx">Guest</span><span class="w"> </span><span class="nx">Tools</span><span class="w">
</span><span class="p">::</span><span class="w"> </span><span class="n">http://edennelson.blogspot.cz/2013/02/deploying-openvpn.html</span><span class="w">
</span><span class="nx">powershell</span><span class="w"> </span><span class="nt">-command</span><span class="w"> </span><span class="s2">"</span><span class="nv">$client</span><span class="s2"> = new-object System.Net.WebClient; </span><span class="nv">$client</span><span class="s2">.DownloadFile('http://zeenix.fedorapeople.org/drivers/win-tools/postinst/redhat10.cer', 'c:\redhat.cer')"</span><span class="w">
</span><span class="n">certutil</span><span class="w"> </span><span class="nt">-addstore</span><span class="w"> </span><span class="s2">"TrustedPublisher"</span><span class="w"> </span><span class="nx">c:\redhat.cer</span><span class="w">
</span><span class="n">del</span><span class="w"> </span><span class="nx">c:\redhat.cer</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-command</span><span class="w"> </span><span class="s2">"</span><span class="nv">$client</span><span class="s2"> = new-object System.Net.WebClient; </span><span class="nv">$client</span><span class="s2">.DownloadFile('http://zeenix.fedorapeople.org/drivers/win-tools/postinst/redhat09.cer', 'c:\redhat.cer')"</span><span class="w">
</span><span class="n">certutil</span><span class="w"> </span><span class="nt">-addstore</span><span class="w"> </span><span class="s2">"TrustedPublisher"</span><span class="w"> </span><span class="nx">c:\redhat.cer</span><span class="w">
</span><span class="n">del</span><span class="w"> </span><span class="nx">c:\redhat.cer</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Change</span><span class="w"> </span><span class="nx">IE</span><span class="w"> </span><span class="nx">homepage</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">disable</span><span class="w"> </span><span class="nx">Tour</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">disable</span><span class="w"> </span><span class="nx">Check</span><span class="w"> </span><span class="nx">Associations</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">disable</span><span class="w"> </span><span class="nx">First</span><span class="w"> </span><span class="nx">Home</span><span class="w"> </span><span class="nx">Page</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">disable</span><span class="w"> </span><span class="nx">OOBE</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">disable</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="nx">Manager</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Main"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="s2">"Start Page"</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="s2">"https://google.com"</span><span class="w"> </span><span class="nx">/f</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKCU\Software\Microsoft\Internet Explorer\Main"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="s2">"Default_Page_URL"</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="s2">"https://google.com"</span><span class="w"> </span><span class="nx">/f</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKCU\Software\Microsoft\Internet Explorer\Main"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="s2">"DisableFirstRunCustomize"</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_DWORD</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="nx">1</span><span class="w"> </span><span class="nx">/f</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Main"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="s2">"Check_Associations"</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="s2">"no"</span><span class="w"> </span><span class="nx">/f</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKCU\Software\Microsoft\Internet Explorer\Main"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="s2">"NoProtectedModeBanner"</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_DWORD</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="nx">1</span><span class="w"> </span><span class="nx">/f</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ServerManager\Oobe"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="s2">"DoNotOpenInitialConfigurationTasksAtLogon"</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_DWORD</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="nx">1</span><span class="w"> </span><span class="nx">/f</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ServerManager"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="s2">"DoNotOpenServerManagerAtLogon"</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_DWORD</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="nx">1</span><span class="w"> </span><span class="nx">/f</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\MAIN\ESCHomePages"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="s2">"SoftAdmin"</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="s2">"https://google.com"</span><span class="w"> </span><span class="nx">/f</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Disable</span><span class="w"> </span><span class="s2">"Check whether IE is the default browser?"</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components\{A509B1A7-37EF-4b3f-8CFC-4F3A74704073}"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="nx">IsInstalled</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_DWORD</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="nx">00000000</span><span class="w"> </span><span class="nx">/f</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Download</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">install</span><span class="w"> </span><span class="nx">7-Zip</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-command</span><span class="w"> </span><span class="s2">"</span><span class="nv">$client</span><span class="s2"> = new-object System.Net.WebClient; </span><span class="nv">$client</span><span class="s2">.DownloadFile('http://switch.dl.sourceforge.net/project/sevenzip/7-Zip/9.20/7z920.msi', 'c:\7z.msi')"</span><span class="w">
</span><span class="n">msiexec</span><span class="w"> </span><span class="nx">/i</span><span class="w"> </span><span class="nx">c:\7z.msi</span><span class="w"> </span><span class="nx">/qn</span><span class="w">
</span><span class="n">del</span><span class="w"> </span><span class="nx">/f</span><span class="w"> </span><span class="nx">c:\7z.msi</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Download</span><span class="w"> </span><span class="nx">SSH</span><span class="w"> </span><span class="nx">Server</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-command</span><span class="w"> </span><span class="s2">"</span><span class="nv">$client</span><span class="s2"> = new-object System.Net.WebClient; </span><span class="nv">$client</span><span class="s2">.DownloadFile('https://www.itefix.no/i2/sites/default/files/Copssh_3.1.4_Installer.zip', 'c:\Copssh_Installer.zip')"</span><span class="w">
</span><span class="s2">"%PROGRAMFILES%\7-Zip\7z.exe"</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="nt">-oc</span><span class="p">:</span><span class="nx">\</span><span class="w"> </span><span class="nx">c:\Copssh_Installer.zip</span><span class="w">
</span><span class="n">c:\Copssh_3.1.4_Installer.exe</span><span class="w"> </span><span class="nx">/u</span><span class="o">=</span><span class="n">root</span><span class="w"> </span><span class="nx">/p</span><span class="o">=</span><span class="n">xxxx</span><span class="w"> </span><span class="nx">/S</span><span class="w">
</span><span class="n">del</span><span class="w"> </span><span class="nx">/f</span><span class="w"> </span><span class="nx">c:\Copssh_3.1.4_Installer.exe</span><span class="w"> </span><span class="nx">c:\Copssh_Installer.zip</span><span class="w">

</span><span class="n">echo</span><span class="w"> </span><span class="nx">ssh-rsa</span><span class="w"> </span><span class="nx">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><span class="w"> </span><span class="nx">ruzickap</span><span class="err">@</span><span class="nx">peru</span><span class="w"> </span><span class="err">&gt;&gt;</span><span class="w"> </span><span class="s2">"%PROGRAMFILES%\ICW\home\Administrator\.ssh\authorized_keys"</span><span class="w">

</span><span class="p">(</span><span class="w">
  </span><span class="n">echo</span><span class="w"> </span><span class="o">---</span><span class="nt">--BEGIN</span><span class="w"> </span><span class="nx">RSA</span><span class="w"> </span><span class="nx">PRIVATE</span><span class="w"> </span><span class="nx">KEY-----</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="nx">REM</span><span class="w"> </span><span class="nx">gitleaks:allow</span><span class="w">
  </span><span class="n">echo</span><span class="w"> </span><span class="nx">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><span class="w">
  </span><span class="n">echo</span><span class="w"> </span><span class="o">---</span><span class="nt">--END</span><span class="w"> </span><span class="nx">RSA</span><span class="w"> </span><span class="nx">PRIVATE</span><span class="w"> </span><span class="nx">KEY-----</span><span class="w">
</span><span class="p">)</span><span class="w">  </span><span class="err">&gt;</span><span class="w"> </span><span class="s2">"%PROGRAMFILES%\ICW\home\Administrator\.ssh\id_rsa"</span><span class="w">

</span><span class="p">(</span><span class="w">
  </span><span class="n">echo</span><span class="w"> </span><span class="nx">Host</span><span class="w"> </span><span class="o">*</span><span class="w">
  </span><span class="n">echo</span><span class="w"> </span><span class="nx">UserKnownHostsFile</span><span class="w"> </span><span class="nx">/dev/null</span><span class="w">
  </span><span class="n">echo</span><span class="w"> </span><span class="nx">StrictHostKeyChecking</span><span class="w"> </span><span class="nx">no</span><span class="w">
  </span><span class="n">echo</span><span class="w"> </span><span class="nx">User</span><span class="w"> </span><span class="nx">root</span><span class="w">
</span><span class="p">)</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="s2">"%PROGRAMFILES%\ICW\home\Administrator\.ssh\config"</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Download</span><span class="w"> </span><span class="nx">an</span><span class="w"> </span><span class="nx">install</span><span class="w"> </span><span class="nx">WinSCP</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-command</span><span class="w"> </span><span class="s2">"</span><span class="nv">$client</span><span class="s2"> = new-object System.Net.WebClient; </span><span class="nv">$client</span><span class="s2">.DownloadFile('http://garr.dl.sourceforge.net/project/winscp/WinSCP/5.1.7/winscp517setup.exe', 'c:\winscpsetup.exe')"</span><span class="w">
</span><span class="n">c:\winscpsetup.exe</span><span class="w"> </span><span class="nx">/silent</span><span class="w"> </span><span class="nx">/sp</span><span class="w">
</span><span class="n">del</span><span class="w"> </span><span class="nx">/f</span><span class="w"> </span><span class="nx">c:\winscpsetup.exe</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKEY_CURRENT_USER\Software\Martin Prikryl\WinSCP 2\Sessions\Default%20Settings"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="s2">"HostName"</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_SZ</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="s2">"192.168.122.1"</span><span class="w"> </span><span class="nx">/f</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKEY_CURRENT_USER\Software\Martin Prikryl\WinSCP 2\Sessions\Default%20Settings"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="s2">"UserName"</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">REG_SZ</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="s2">"ruzickap"</span><span class="w"> </span><span class="nx">/f</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Download</span><span class="w"> </span><span class="nx">an</span><span class="w"> </span><span class="nx">install</span><span class="w"> </span><span class="nx">Double</span><span class="w"> </span><span class="nx">Commander</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-command</span><span class="w"> </span><span class="s2">"</span><span class="nv">$client</span><span class="s2"> = new-object System.Net.WebClient; </span><span class="nv">$client</span><span class="s2">.DownloadFile('http://optimate.dl.sourceforge.net/project/doublecmd/DC%%20for%%20Windows%%2032%%20bit/Double%%20Commander%%200.5.6%%20beta/doublecmd-0.5.6.i386-win32.exe', 'c:\doublecmd.exe')"</span><span class="w">
</span><span class="n">c:\doublecmd.exe</span><span class="w"> </span><span class="nx">/sp</span><span class="w"> </span><span class="nx">/silent</span><span class="w"> </span><span class="nx">/MERGETASKS</span><span class="o">=</span><span class="s2">"desktopicon"</span><span class="w">
</span><span class="n">del</span><span class="w"> </span><span class="nx">/f</span><span class="w"> </span><span class="nx">c:\doublecmd.exe</span><span class="w">


</span><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="nx">Download</span><span class="w"> </span><span class="nx">Putty</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-command</span><span class="w"> </span><span class="s2">"</span><span class="nv">$client</span><span class="s2"> = new-object System.Net.WebClient; </span><span class="nv">$client</span><span class="s2">.DownloadFile('http://the.earth.li/~sgtatham/putty/latest/x86/putty-0.63-installer.exe', 'c:\putty-installer.exe')"</span><span class="w">
</span><span class="n">c:\putty-installer.exe</span><span class="w"> </span><span class="nx">/silent</span><span class="w"> </span><span class="nx">/sp</span><span class="w"> </span><span class="nx">/MERGETASKS</span><span class="o">=</span><span class="s2">"desktopicon"</span><span class="w">
</span><span class="n">del</span><span class="w"> </span><span class="nx">/f</span><span class="w"> </span><span class="nx">c:\putty-installer.exe</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Download</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">install</span><span class="w"> </span><span class="nx">Firefox</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-command</span><span class="w"> </span><span class="s2">"</span><span class="nv">$client</span><span class="s2"> = new-object System.Net.WebClient; </span><span class="nv">$client</span><span class="s2">.DownloadFile('http://download.cdn.mozilla.net/pub/mozilla.org/firefox/releases/23.0.1/win32/en-US/Firefox%%20Setup%%2023.0.1.exe', 'c:\Firefox_Setup.exe')"</span><span class="w">
</span><span class="n">c:\Firefox_Setup.exe</span><span class="w"> </span><span class="nt">-ms</span><span class="w">
</span><span class="n">del</span><span class="w"> </span><span class="nx">/f</span><span class="w"> </span><span class="nx">c:\Firefox_Setup.exe</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Download</span><span class="w"> </span><span class="nx">Notepad</span><span class="o">++</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-command</span><span class="w"> </span><span class="s2">"</span><span class="nv">$client</span><span class="s2"> = new-object System.Net.WebClient; </span><span class="nv">$client</span><span class="s2">.DownloadFile('http://download.tuxfamily.org/notepadplus/6.4.1/npp.6.4.1.Installer.exe', 'c:\npp.Installer.exe')"</span><span class="w">
</span><span class="n">c:\npp.Installer.exe</span><span class="w"> </span><span class="nx">/S</span><span class="w">
</span><span class="n">del</span><span class="w"> </span><span class="nx">/f</span><span class="w"> </span><span class="nx">c:\npp.Installer.exe</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Download</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">install</span><span class="w"> </span><span class="nx">Spice</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-command</span><span class="w"> </span><span class="s2">"</span><span class="nv">$client</span><span class="s2"> = new-object System.Net.WebClient; </span><span class="nv">$client</span><span class="s2">.DownloadFile('http://spice-space.org/download/windows/spice-guest-tools/spice-guest-tools-0.59.exe', 'c:\spice-guest-tools.exe')"</span><span class="w">
</span><span class="n">c:\spice-guest-tools.exe</span><span class="w"> </span><span class="nx">/S</span><span class="w">
</span><span class="n">del</span><span class="w"> </span><span class="nx">/f</span><span class="w"> </span><span class="nx">c:\spice-guest-tools.exe</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Download</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">install</span><span class="w"> </span><span class="nx">JRE</span><span class="w">
</span><span class="n">rem</span><span class="w"> </span><span class="nx">powershell</span><span class="w"> </span><span class="nt">-command</span><span class="w"> </span><span class="s2">"</span><span class="nv">$client</span><span class="s2"> = new-object System.Net.WebClient; </span><span class="nv">$client</span><span class="s2">.DownloadFile('http://download.kb.cz/jre-7u45-windows-i586.exe', 'c:\jre-windows.exe')"</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-command</span><span class="w"> </span><span class="s2">"</span><span class="nv">$client</span><span class="s2"> = new-object System.Net.WebClient; </span><span class="nv">$client</span><span class="s2">.DownloadFile('http://javadl.sun.com/webapps/download/AutoDL?BundleId=81819', 'c:\jre-windows.exe')"</span><span class="w">
</span><span class="n">c:\jre-windows.exe</span><span class="w"> </span><span class="nx">/s</span><span class="w">
</span><span class="n">del</span><span class="w"> </span><span class="nx">/f</span><span class="w"> </span><span class="nx">c:\jre-windows.exe</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Download</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">install</span><span class="w"> </span><span class="nx">DesktopInfo</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-command</span><span class="w"> </span><span class="s2">"</span><span class="nv">$client</span><span class="s2"> = new-object System.Net.WebClient; </span><span class="nv">$client</span><span class="s2">.DownloadFile('http://www.glenn.delahoy.com/software/files/DesktopInfo120.zip', 'c:\DesktopInfo.zip')"</span><span class="w">
</span><span class="s2">"%PROGRAMFILES%\7-Zip\7z.exe"</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="nt">-o</span><span class="s2">"%PROGRAMFILES%\DesktopInfo"</span><span class="w"> </span><span class="nx">c:\DesktopInfo.zip</span><span class="w">
</span><span class="n">del</span><span class="w"> </span><span class="nx">c:\DesktopInfo.zip</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="s2">"HKCU\Software\Microsoft\Windows\CurrentVersion\Run"</span><span class="w"> </span><span class="nx">/v</span><span class="w"> </span><span class="nx">DesktopInfo</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">reg_sz</span><span class="w"> </span><span class="nx">/d</span><span class="w"> </span><span class="s2">"%PROGRAMFILES%\DesktopInfo\DesktopInfo.exe"</span><span class="w"> </span><span class="nx">/f</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Disable</span><span class="w"> </span><span class="nx">Hibernate</span><span class="w">
</span><span class="n">powercfg</span><span class="w"> </span><span class="nt">-h</span><span class="w"> </span><span class="nx">off</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Disable</span><span class="w"> </span><span class="nx">piracy</span><span class="w"> </span><span class="nx">warning</span><span class="w">
</span><span class="n">start</span><span class="w"> </span><span class="nx">SLMGR</span><span class="w"> </span><span class="nt">-REARM</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Change</span><span class="w"> </span><span class="nx">pagefile</span><span class="w"> </span><span class="nx">size</span><span class="w">
</span><span class="n">wmic.exe</span><span class="w"> </span><span class="nx">computersystem</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">AutomaticManagedPagefile</span><span class="o">=</span><span class="n">False</span><span class="w">
</span><span class="nx">wmic</span><span class="w"> </span><span class="nx">pagefileset</span><span class="w"> </span><span class="nx">where</span><span class="w"> </span><span class="nx">name</span><span class="o">=</span><span class="s2">"C:\\pagefile.sys"</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="nx">InitialSize</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span><span class="n">MaximumSize</span><span class="o">=</span><span class="mi">512</span><span class="w">
</span><span class="n">wmic</span><span class="w"> </span><span class="nx">pagefileset</span><span class="w"> </span><span class="nx">list</span><span class="w"> </span><span class="nx">/format:list</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Clean</span><span class="w"> </span><span class="nx">mess</span><span class="w">
</span><span class="n">cleanmgr</span><span class="w"> </span><span class="nx">/sagerun:11</span><span class="w">


</span><span class="err">@</span><span class="n">echo.</span><span class="w">
</span><span class="err">@</span><span class="nx">echo</span><span class="w"> </span><span class="nx">Compact</span><span class="w"> </span><span class="nx">all</span><span class="w"> </span><span class="nx">files</span><span class="w">
</span><span class="n">compact</span><span class="w"> </span><span class="nx">/c</span><span class="w"> </span><span class="nx">/s</span><span class="w"> </span><span class="nx">/i</span><span class="w"> </span><span class="nx">/q</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">NUL</span><span class="w">

</span><span class="n">pause</span><span class="w">

</span><span class="n">shutdown</span><span class="w"> </span><span class="nx">/r</span><span class="w"> </span><span class="nx">/t</span><span class="w"> </span><span class="nx">0</span><span class="w">
</span><span class="n">move</span><span class="w"> </span><span class="nx">c:\win7-admin.bat</span><span class="w"> </span><span class="nx">c:\windows\temp\</span><span class="w">
</span></pre></table></code></div></div><p>Feel free to see the whole installation procedure on this video (some parts are accelerated):</p><iframe class="embed-video" loading="lazy" src="https://www.youtube.com/embed/0Tnqj8ZYKB0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><p>:-)</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/virtualization/">Virtualization</a>, <a href="/categories/windows/">Windows</a>, <a href="/categories/linux-xvx-cz/">linux.xvx.cz</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/kvm/" class="post-tag no-text-decoration" >kvm</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a> <a href="/tags/automation/" class="post-tag no-text-decoration" >automation</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Automated%20installation%20of%20Windows%207%20in%20KVM%20-%20Petr's%20Blog&url=https%3A%2F%2Fruzickap.github.io%2Fposts%2Fautomated-installation-of-windows-7-in-kvm%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Automated%20installation%20of%20Windows%207%20in%20KVM%20-%20Petr's%20Blog&u=https%3A%2F%2Fruzickap.github.io%2Fposts%2Fautomated-installation-of-windows-7-in-kvm%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fruzickap.github.io%2Fposts%2Fautomated-installation-of-windows-7-in-kvm%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <script defer type="module" src="https://cdn.jsdelivr.net/npm/@justinribeiro/share-to-mastodon/+esm"></script> <button class="btn text-start" data-bs-toggle="tooltip" data-bs-placement="top" title="Mastodon" aria-label="Mastodon"> <share-to-mastodon class="share-mastodon" message="Automated%20installation%20of%20Windows%207%20in%20KVM%20-%20Petr's%20Blog" url="https%3A%2F%2Fruzickap.github.io%2Fposts%2Fautomated-installation-of-windows-7-in-kvm%2F"customInstanceList="[{&quot;label&quot;:&quot;mastodon.social&quot;,&quot;link&quot;:&quot;https://mastodon.social/&quot;},{&quot;label&quot;:&quot;mastodon.online&quot;,&quot;link&quot;:&quot;https://mastodon.online/&quot;},{&quot;label&quot;:&quot;fosstodon.org&quot;,&quot;link&quot;:&quot;https://fosstodon.org/&quot;},{&quot;label&quot;:&quot;photog.social&quot;,&quot;link&quot;:&quot;https://photog.social/&quot;}]" > <i class="fa-fw fa-brands fa-mastodon"></i> </share-to-mastodon> </button> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/installtion-f5-bigip-virtual-edition-to-rhel7/">Installation F5 BIGIP Virtual Edition to RHEL7</a><li class="text-truncate lh-lg"> <a href="/posts/detect-a-hacker-attacks-eks-vm/">Detect the hacker attacks on Amazon EKS and EC2 instances</a><li class="text-truncate lh-lg"> <a href="/posts/secure-cheap-amazon-eks-auto/">Build secure and cheap Amazon EKS Auto Mode</a><li class="text-truncate lh-lg"> <a href="/posts/eks-auto-cert-manager-velero/">Amazon EKS Auto Mode with cert-manager and Velero</a><li class="text-truncate lh-lg"> <a href="/posts/mcp-servers-k8s/">MCP Servers running on Kubernetes</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/amazon-eks/">amazon-eks</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/cert-manager/">cert-manager</a> <a class="post-tag btn btn-outline-primary" href="/tags/eksctl/">eksctl</a> <a class="post-tag btn btn-outline-primary" href="/tags/bash/">bash</a> <a class="post-tag btn btn-outline-primary" href="/tags/pxe/">pxe</a> <a class="post-tag btn btn-outline-primary" href="/tags/wifi/">wifi</a> <a class="post-tag btn btn-outline-primary" href="/tags/prometheus/">prometheus</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a></div></section></div></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/create-windows-image-using-packer-and-ansible-and-then-run-it-in-vagrant-libvirt/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1508796000" data-df="ll" > Oct 24, 2017 </time><h4 class="pt-0 my-2">Create Windows image using Packer and Ansible and then run it in Vagrant (libvirt)</h4><div class="text-muted"><p>Create Windows image using Packer and Ansible and then run it in Vagrant (libvirt)</p></div></div></a></article><article class="col"> <a href="/posts/create-lab-infrastructure-running-virtual-machines-with-maas-using-vagrant/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1519081200" data-df="ll" > Feb 20, 2018 </time><h4 class="pt-0 my-2">Create lab infrastructure running Virtual machines with MAAS using Vagrant</h4><div class="text-muted"><p>Create lab infrastructure running Virtual machines with MAAS using Vagrant</p></div></div></a></article><article class="col"> <a href="/posts/setup-production-ready-kubernetes-cluster-using-kubespray-and-vagrant-running-on-the-libvirt-kvms/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1509577200" data-df="ll" > Nov 2, 2017 </time><h4 class="pt-0 my-2">Setup production ready Kubernetes cluster using Kubespray and Vagrant running on the libvirt KVMs</h4><div class="text-muted"><p>Setup production ready Kubernetes cluster using Kubespray and Vagrant running on the libvirt KVMs</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/how-to-get-hp-enclosure-c7000-information-without-ssh/" class="btn btn-outline-primary" aria-label="Older" ><p>How to get HP enclosure c7000 information without ssh</p></a> <a href="/posts/server-raidbios-changes-using-hp-scripting-toolkit-and-cobbler/" class="btn btn-outline-primary" aria-label="Newer" ><p>Server RAID/BIOS changes using HP Scripting toolkit and Cobbler</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2026</time> <a href="https://twitter.com/Ruzicka_Petr">Petr Ruzicka</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.4.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/amazon-eks/">amazon-eks</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/cert-manager/">cert-manager</a> <a class="post-tag btn btn-outline-primary" href="/tags/eksctl/">eksctl</a> <a class="post-tag btn btn-outline-primary" href="/tags/bash/">bash</a> <a class="post-tag btn btn-outline-primary" href="/tags/pxe/">pxe</a> <a class="post-tag btn btn-outline-primary" href="/tags/wifi/">wifi</a> <a class="post-tag btn btn-outline-primary" href="/tags/prometheus/">prometheus</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ruzickap/ruzickap.github.io', 'data-repo-id': 'R_kgDOGkp4nQ', 'data-category': 'General', 'data-category-id': 'DIC_kwDOGkp4nc4CSdu1', 'data-mapping': 'pathname', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
