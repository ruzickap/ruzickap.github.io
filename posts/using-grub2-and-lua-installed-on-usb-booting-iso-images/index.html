<!doctype html><html lang="en" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Using Grub2 and LUA installed on USB booting ISO images" /><meta name="author" content="Petr Ruzicka" /><meta property="og:locale" content="en" /><meta name="description" content="Create a bootable USB drive with GRUB2 and LUA to auto-detect and boot multiple Linux live ISO images" /><meta property="og:description" content="Create a bootable USB drive with GRUB2 and LUA to auto-detect and boot multiple Linux live ISO images" /><link rel="canonical" href="https://ruzickap.github.io/posts/using-grub2-and-lua-installed-on-usb-booting-iso-images/" /><meta property="og:url" content="https://ruzickap.github.io/posts/using-grub2-and-lua-installed-on-usb-booting-iso-images/" /><meta property="og:site_name" content="Petr’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2010-03-23T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Using Grub2 and LUA installed on USB booting ISO images" /><meta name="twitter:site" content="@Ruzicka_Petr" /><meta name="twitter:creator" content="@Ruzicka_Petr" /><meta name="google-site-verification" content="4ugGShJoiB9veoPwFcMsMjzk-1BYbi5ozcSnovkBWtA" /><meta name="msvalidate.01" content="592AB158E3F9EF887F8DC8E69A2FF754" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Petr Ruzicka","url":"https://petr.ruzicka.dev"},"dateModified":"2026-02-08T18:16:39+01:00","datePublished":"2010-03-23T00:00:00+01:00","description":"Create a bootable USB drive with GRUB2 and LUA to auto-detect and boot multiple Linux live ISO images","headline":"Using Grub2 and LUA installed on USB booting ISO images","mainEntityOfPage":{"@type":"WebPage","@id":"https://ruzickap.github.io/posts/using-grub2-and-lua-installed-on-usb-booting-iso-images/"},"url":"https://ruzickap.github.io/posts/using-grub2-and-lua-installed-on-usb-booting-iso-images/"}</script><title>Using Grub2 and LUA installed on USB booting ISO images | Petr's Blog</title><link rel="icon" type="image/png" href="/assets/img/favicons/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/svg+xml" href="/assets/img/favicons/favicon.svg"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.36.4/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.18/dayjs.min.js,npm/dayjs@1.11.18/locale/en.js,npm/dayjs@1.11.18/plugin/relativeTime.js,npm/dayjs@1.11.18/plugin/localizedFormat.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> document.addEventListener('DOMContentLoaded', () => { const pv = document.getElementById('pageviews'); if (pv !== null) { const uri = location.pathname.replace(/\/$/, ''); const url = `https://ruzickap-github-io.goatcounter.com/counter/${encodeURIComponent(uri)}.json`; fetch(url) .then((response) => response.json()) .then((data) => { const count = data.count.replace(/\D/g, ''); pv.innerText = new Intl.NumberFormat().format(count); }) .catch((error) => { pv.innerText = '1'; }); } }); </script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-64WRCWDZM8"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-64WRCWDZM8'); }); </script> <script async src="https://gc.zgo.at/count.js" data-goatcounter="https://ruzickap-github-io.goatcounter.com/count" ></script> <script defer src="https://cloud.umami.is/script.js" data-website-id="380ea41a-7d5f-4423-8e13-03151bde195f" ></script> <script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token": "ad8c64404e1e41dba184019564cf11bb"}' ></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="https://0.gravatar.com/avatar/5484c0fd9f98e2ffd9212b158931bf4b?s=200" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Petr's Blog</a><p class="site-subtitle fst-italic mb-0">DevOps • GitOps • K8s</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/projects/" class="nav-link"> <i class="fa-fw fas fa-project-diagram"></i> <span>PROJECTS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/ruzickap" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['petr.ruzicka','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://petr.ruzicka.dev" aria-label="homepage" target="_blank" rel="noopener noreferrer" > <i class="fas fa-home"></i> </a> <a href="https://mastodon.social/@petr_ruzicka" aria-label="mastodon" target="_blank" rel="noopener noreferrer me" > <i class="fab fa-mastodon"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Using Grub2 and LUA installed on USB booting ISO images</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="false"><header><h1 data-toc-skip>Using Grub2 and LUA installed on USB booting ISO images</h1><p class="post-desc fw-light mb-4">Create a bootable USB drive with GRUB2 and LUA to auto-detect and boot multiple Linux live ISO images</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1269298800" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Mar 23, 2010 </time> </span> <span> Updated <time data-ts="1770570999" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Feb 8, 2026 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://petr.ruzicka.dev">Petr Ruzicka</a> </em> </span><div> <span> <em id="pageviews"> <i class="fas fa-spinner fa-spin small"></i> </em> views </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1250 words" > <em>6 min</em> read</span></div></div></div></header><div class="content"><blockquote class="prompt-info"><p><a href="https://linux-old.xvx.cz/2010/03/using-grub2-and-lua-installed-on-usb-booting-iso-images-2/">https://linux-old.xvx.cz/2010/03/using-grub2-and-lua-installed-on-usb-booting-iso-images-2/</a></p></blockquote><p>I got 16 GB <a href="https://en.wikipedia.org/wiki/USB_flash_drive">USB flash</a> from my brother, because he can’t see me still using my old 64 MB. He decided to buy Imation Nano Flash Drive.</p><p>Because many of my friends and colleagues are using Windows, I use <a href="https://en.wikipedia.org/wiki/NTFS">NTFS</a> on it. Old FAT is not “usable” in these days, because it can’t handle bigger files.</p><p>From the first time I used USB disks I always wanted to have a bootable disk/flash with live CDs - so here are a few notes on how to create a USB flash drive able to boot stored live CDs:</p><p>First you need to compile <a href="https://www.gnu.org/software/grub/index.html">grub2</a> yourself, because default grub2 installations in distributions do not have <a href="https://en.wikipedia.org/wiki/Lua_%28programming_language%29">LUA</a> support:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>aptitude <span class="nb">install </span>autogen automake bison flex gettext gcc autoconf ruby bzr libfreetype6-dev
</pre></table></code></div></div><p>Debian way compilation and installation:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>aptitude <span class="nb">install </span>dpkg-dev fakeroot
apt-get <span class="nb">source </span>grub2
apt-get build-dep grub2
dpkg-source <span class="nt">-x</span> grub2_1.98-1.dsc

bzr branch http://bzr.savannah.gnu.org/r/grub-extras/lua ./grub2-1.98/debian/grub-extras/lua

<span class="o">(</span>
  <span class="nb">cd </span>grub2-1.98 <span class="o">||</span> <span class="nb">exit
  </span>dpkg-buildpackage <span class="nt">-rfakeroot</span> <span class="nt">-b</span>
<span class="o">)</span>
dpkg <span class="nt">-r</span> grub-pc grub-common
dpkg <span class="nt">-i</span> ./grub-common_1.98-1_amd64.deb ./grub-pc_1.98-1_amd64.deb
</pre></table></code></div></div><p>Compilation and installation from source code (not necessary if you follow “Debian steps” above):</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>bzr branch http://bzr.savannah.gnu.org/r/grub/trunk/grub
<span class="nb">mkdir</span> ./grub/grub-extras
bzr branch http://bzr.savannah.gnu.org/r/grub-extras/lua ./grub/grub-extras/lua
<span class="c">#bzr branch http://bzr.savannah.gnu.org/r/grub-extras/gpxe ./grub/grub-extras/gpxe</span>

<span class="o">(</span>
  <span class="nb">cd </span>grub <span class="o">||</span> <span class="nb">exit
  export </span><span class="nv">GRUB_CONTRIB</span><span class="o">=</span>./grub-extras/
  ./autogen.sh
  ./configure <span class="nt">--prefix</span><span class="o">=</span>/tmp/grub
  make
  make <span class="nb">install</span>
<span class="o">)</span>
</pre></table></code></div></div><p>Mount USB to some directory (in my case <code class="language-plaintext highlighter-rouge">/mnt/sdb1</code>) and install grub with Lua support on it:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>mount /dev/sdb1 /mnt/sdb1
grub-install <span class="nt">--root-directory</span><span class="o">=</span>/mnt/sdb1 /dev/sdb
</pre></table></code></div></div><p>To make grub nicer, I add wallpaper and fonts to it:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>wget <span class="nt">--directory-prefix</span><span class="o">=</span>/tmp/ http://unifoundry.com/unifont-5.1.20080820.pcf.gz
grub-mkfont <span class="nt">--output</span><span class="o">=</span>/mnt/sdb1/boot/grub/unifont.pf2 <span class="nt">--range</span><span class="o">=</span>0x0000-0x0241,0x2190-0x21FF,0x2500-0x259f /tmp/unifont-5.1.20080820.pcf.gz <span class="nt">-v</span> <span class="nt">-b</span>
wget http://ubuntulife.files.wordpress.com/2007/05/linux.jpg /mnt/sdb1/boot/grub/
</pre></table></code></div></div><p>Last step is creating right configuration and downloading live iso images of various Linux distributions:</p><p>Let’s download the ISOs first. It’s better to use most actual ones. These are working fine for me:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nb">mkdir</span> <span class="nt">-v</span> /mnt/sdb1/isos
wget <span class="nt">-c</span> <span class="nt">--directory-prefix</span><span class="o">=</span>/mnt/sdb1/isos <span class="se">\</span>
  http://ftp.heanet.ie/pub/linuxmint.com/testing/LinuxMint-8-x64-RC1.iso <span class="se">\</span>
  http://gd.tuwien.ac.at/opsys/linux/grml/grml64_2009.10.iso <span class="se">\</span>
  http://ftp.cc.uoc.gr/mirrors/linux/slax/SLAX-6.x/slax-6.1.2.iso <span class="se">\</span>
  http://downloads.sourceforge.net/project/systemrescuecd/sysresccd-x86/1.5.0/systemrescuecd-x86-1.5.0.iso <span class="se">\</span>
  http://releases.ubuntu.com/karmic/ubuntu-9.10-desktop-amd64.iso <span class="se">\</span>
  http://xpud.googlecode.com/files/xpud-0.9.2.iso
</pre></table></code></div></div><p>The following code is taken from <a href="https://ubuntuforums.org">Ubuntu Forums</a> where I added more live CDs. I also changed the main <code class="language-plaintext highlighter-rouge">grub.cfg</code> a little bit and use 64 live CDs <code class="language-plaintext highlighter-rouge">amd64</code>.</p><p>Save following text as 3 files:</p><ul><li><p><code class="language-plaintext highlighter-rouge">/mnt/sdb1/boot/grub/grub.cfg</code>:</p><div class="language-lua highlighter-rouge"><div class="code-header"> <span data-label-text="Lua"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="n">insmod</span> <span class="n">vbeinfo</span>
<span class="n">insmod</span> <span class="n">font</span>

<span class="k">if</span> <span class="n">loadfont</span> <span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">grub</span><span class="o">/</span><span class="n">unifont</span><span class="p">.</span><span class="n">pf2</span><span class="p">;</span> <span class="k">then</span>
  <span class="n">set</span> <span class="n">gfxmode</span><span class="o">=</span><span class="s2">"1024x768x32,800x600x32,640x480x32,1024x768,800x600,640x480"</span>
  <span class="o">#</span> <span class="n">set</span> <span class="n">gfxpayload</span><span class="o">=</span><span class="n">keep</span>
  <span class="n">insmod</span> <span class="n">gfxterm</span>
  <span class="o">#</span> <span class="n">insmod</span> <span class="n">vbe</span>
  <span class="k">if</span> <span class="n">terminal_output</span> <span class="n">gfxterm</span><span class="p">;</span> <span class="k">then</span> <span class="kc">true</span> <span class="p">;</span> <span class="k">else</span>
     <span class="n">terminal</span> <span class="n">gfxterm</span>
  <span class="n">fi</span>
<span class="n">fi</span>

<span class="n">insmod</span> <span class="n">jpeg</span>
<span class="k">if</span> <span class="n">background_image</span> <span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">grub</span><span class="o">/</span><span class="n">linux</span><span class="p">.</span><span class="n">jpg</span><span class="p">;</span> <span class="k">then</span>
  <span class="n">set</span> <span class="n">menu_color_normal</span><span class="o">=</span><span class="n">black</span><span class="o">/</span><span class="n">black</span>
  <span class="n">set</span> <span class="n">color_highlight</span><span class="o">=</span><span class="n">red</span><span class="o">/</span><span class="n">blue</span>
<span class="k">else</span>
  <span class="n">set</span> <span class="n">menu_color_normal</span><span class="o">=</span><span class="n">cyan</span><span class="o">/</span><span class="n">blue</span>
  <span class="n">set</span> <span class="n">menu_color_highlight</span><span class="o">=</span><span class="n">white</span><span class="o">/</span><span class="n">blue</span>
<span class="n">fi</span>

<span class="n">set</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span>
<span class="n">set</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span>

<span class="o">#</span> <span class="n">Uncomment</span> <span class="k">for</span> <span class="n">a</span> <span class="n">different</span> <span class="n">ISO</span> <span class="n">files</span> <span class="n">search</span> <span class="n">path</span>
<span class="o">#</span><span class="n">set</span> <span class="n">isofolder</span><span class="o">=</span><span class="s2">"/boot/isos"</span>
<span class="o">#</span><span class="n">export</span> <span class="n">isofolder</span>

<span class="o">#</span> <span class="n">Uncomment</span> <span class="k">for</span> <span class="n">a</span> <span class="n">different</span> <span class="n">live</span> <span class="n">system</span> <span class="n">language</span>
<span class="o">#</span><span class="n">set</span> <span class="n">isolangcode</span><span class="o">=</span><span class="s2">"us"</span>
<span class="o">#</span><span class="n">export</span> <span class="n">isolangcode</span>

<span class="n">source</span> <span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">grub</span><span class="o">/</span><span class="n">listisos</span><span class="p">.</span><span class="n">lua</span>
</pre></table></code></div></div><li><p><code class="language-plaintext highlighter-rouge">/mnt/sdb1/boot/grub/bootiso.lua</code>:</p><div class="language-lua highlighter-rouge"><div class="code-header"> <span data-label-text="Lua"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
</pre><td class="rouge-code"><pre><span class="cp">#!lua</span>

<span class="c1">-- Detects the live system type and boots it</span>
<span class="k">function</span> <span class="nf">boot_iso</span> <span class="p">(</span><span class="n">isofile</span><span class="p">,</span> <span class="n">langcode</span><span class="p">)</span>
  <span class="c1">-- grml</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">dir_exist</span> <span class="p">(</span><span class="s2">"(loop)/boot/grml64"</span><span class="p">))</span> <span class="k">then</span>
    <span class="n">boot_linux</span> <span class="p">(</span>
      <span class="s2">"(loop)/boot/grml64/linux26"</span><span class="p">,</span>
      <span class="s2">"(loop)/boot/grml64/initrd.gz"</span><span class="p">,</span>
      <span class="s2">"findiso="</span> <span class="o">..</span> <span class="n">isofile</span> <span class="o">..</span> <span class="s2">" apm=power-off quiet boot=live nomce"</span>
    <span class="p">)</span>
  <span class="c1">-- Parted Magic</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="n">dir_exist</span> <span class="p">(</span><span class="s2">"(loop)/pmagic"</span><span class="p">))</span> <span class="k">then</span>
    <span class="n">boot_linux</span> <span class="p">(</span>
      <span class="s2">"(loop)/pmagic/bzImage"</span><span class="p">,</span>
      <span class="s2">"(loop)/pmagic/initramfs"</span><span class="p">,</span>
      <span class="s2">"iso_filename="</span> <span class="o">..</span> <span class="n">isofile</span> <span class="o">..</span>
        <span class="s2">" edd=off noapic load_ramdisk=1 prompt_ramdisk=0 rw"</span> <span class="o">..</span>
        <span class="s2">" sleep=10 loglevel=0 keymap="</span> <span class="o">..</span> <span class="n">langcode</span>
    <span class="p">)</span>
  <span class="c1">-- Sidux</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="n">dir_exist</span> <span class="p">(</span><span class="s2">"(loop)/sidux"</span><span class="p">))</span> <span class="k">then</span>
    <span class="n">boot_linux</span> <span class="p">(</span>
      <span class="n">find_file</span> <span class="p">(</span><span class="s2">"(loop)/boot"</span><span class="p">,</span> <span class="s2">"vmlinuz%-.*%-sidux%-.*"</span><span class="p">),</span>
      <span class="n">find_file</span> <span class="p">(</span><span class="s2">"(loop)/boot"</span><span class="p">,</span> <span class="s2">"initrd%.img%-.*%-sidux%-.*"</span><span class="p">),</span>
      <span class="s2">"fromiso="</span> <span class="o">..</span> <span class="n">isofile</span> <span class="o">..</span> <span class="s2">" boot=fll quiet"</span>
    <span class="p">)</span>
  <span class="c1">-- Slax</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="n">dir_exist</span> <span class="p">(</span><span class="s2">"(loop)/slax"</span><span class="p">))</span> <span class="k">then</span>
    <span class="n">boot_linux</span> <span class="p">(</span>
      <span class="s2">"(loop)/boot/vmlinuz"</span><span class="p">,</span>
      <span class="s2">"(loop)/boot/initrd.gz"</span><span class="p">,</span>
      <span class="s2">"from="</span> <span class="o">..</span> <span class="n">isofile</span> <span class="o">..</span> <span class="s2">" ramdisk_size=6666 root=/dev/ram0 rw"</span>
    <span class="p">)</span>
  <span class="c1">-- SystemRescueCd</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="n">grub</span><span class="p">.</span><span class="n">file_exist</span> <span class="p">(</span><span class="s2">"(loop)/isolinux/rescue64"</span><span class="p">))</span> <span class="k">then</span>
    <span class="n">boot_linux</span> <span class="p">(</span>
      <span class="s2">"(loop)/isolinux/rescue64"</span><span class="p">,</span>
      <span class="s2">"(loop)/isolinux/initram.igz"</span><span class="p">,</span>
      <span class="s2">"isoloop="</span> <span class="o">..</span> <span class="n">isofile</span> <span class="o">..</span> <span class="s2">" docache rootpass=xxxx setkmap="</span> <span class="o">..</span> <span class="n">langcode</span>
    <span class="p">)</span>
  <span class="c1">-- Tinycore</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="n">grub</span><span class="p">.</span><span class="n">file_exist</span> <span class="p">(</span><span class="s2">"(loop)/boot/tinycore.gz"</span><span class="p">))</span> <span class="k">then</span>
    <span class="n">boot_linux</span> <span class="p">(</span>
      <span class="s2">"(loop)/boot/bzImage"</span><span class="p">,</span>
      <span class="s2">"(loop)/boot/tinycore.gz"</span>
    <span class="p">)</span>
  <span class="c1">-- Ubuntu and Casper based Distros</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="n">dir_exist</span> <span class="p">(</span><span class="s2">"(loop)/casper"</span><span class="p">))</span> <span class="k">then</span>
    <span class="n">boot_linux</span> <span class="p">(</span>
      <span class="s2">"(loop)/casper/vmlinuz"</span><span class="p">,</span>
      <span class="n">find_file</span> <span class="p">(</span><span class="s2">"(loop)/casper"</span><span class="p">,</span> <span class="s2">"initrd%..z"</span><span class="p">),</span>
      <span class="s2">"boot=casper iso-scan/filename="</span> <span class="o">..</span> <span class="n">isofile</span> <span class="o">..</span>
        <span class="s2">" quiet splash noprompt"</span> <span class="o">..</span>
        <span class="s2">" keyb="</span> <span class="o">..</span> <span class="n">langcode</span> <span class="o">..</span>
        <span class="s2">" debian-installer/language="</span> <span class="o">..</span> <span class="n">langcode</span> <span class="o">..</span>
        <span class="s2">" console-setup/layoutcode?="</span> <span class="o">..</span> <span class="n">langcode</span> <span class="o">..</span>
        <span class="s2">" --"</span>
    <span class="p">)</span>
  <span class="c1">-- Xpud</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="n">grub</span><span class="p">.</span><span class="n">file_exist</span> <span class="p">(</span><span class="s2">"(loop)/boot/xpud"</span><span class="p">))</span> <span class="k">then</span>
    <span class="n">boot_linux</span> <span class="p">(</span>
      <span class="s2">"(loop)/boot/xpud"</span><span class="p">,</span>
      <span class="s2">"(loop)/opt/media"</span>
    <span class="p">)</span>
  <span class="k">else</span>
    <span class="n">print_error</span> <span class="p">(</span><span class="s2">"Unsupported ISO type"</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1">-- Help function to show an error</span>
<span class="k">function</span> <span class="nf">print_error</span> <span class="p">(</span><span class="n">msg</span><span class="p">)</span>
  <span class="nb">print</span> <span class="p">(</span><span class="s2">"Error: "</span> <span class="o">..</span> <span class="n">msg</span><span class="p">)</span>
  <span class="n">grub</span><span class="p">.</span><span class="n">run</span> <span class="p">(</span><span class="s2">"read"</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1">-- Help function to search for a file</span>
<span class="k">function</span> <span class="nf">find_file</span> <span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">match</span><span class="p">)</span>
  <span class="kd">local</span> <span class="n">filename</span>

  <span class="kd">local</span> <span class="k">function</span> <span class="nf">enum_file</span> <span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">filename</span> <span class="o">==</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
      <span class="n">filename</span> <span class="o">=</span> <span class="nb">string.match</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">match</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="n">grub</span><span class="p">.</span><span class="n">enum_file</span> <span class="p">(</span><span class="n">enum_file</span><span class="p">,</span> <span class="n">folder</span><span class="p">)</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">then</span>
    <span class="k">return</span> <span class="n">folder</span> <span class="o">..</span> <span class="s2">"/"</span> <span class="o">..</span> <span class="n">filename</span>
  <span class="k">else</span>
    <span class="k">return</span> <span class="kc">nil</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1">-- Help function to check if a directory exist</span>
<span class="k">function</span> <span class="nf">dir_exist</span> <span class="p">(</span><span class="n">dir</span><span class="p">)</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">grub</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="s2">"test -d '"</span> <span class="o">..</span> <span class="n">dir</span> <span class="o">..</span> <span class="s2">"'"</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1">-- Boots a Linux live system</span>
<span class="k">function</span> <span class="nf">boot_linux</span> <span class="p">(</span><span class="n">linux</span><span class="p">,</span> <span class="n">initrd</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">linux</span> <span class="ow">and</span> <span class="n">grub</span><span class="p">.</span><span class="n">file_exist</span> <span class="p">(</span><span class="n">linux</span><span class="p">))</span> <span class="k">then</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">initrd</span> <span class="ow">and</span> <span class="n">grub</span><span class="p">.</span><span class="n">file_exist</span> <span class="p">(</span><span class="n">initrd</span><span class="p">))</span> <span class="k">then</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="k">then</span>
        <span class="n">grub</span><span class="p">.</span><span class="n">run</span> <span class="p">(</span><span class="s2">"linux "</span> <span class="o">..</span> <span class="n">linux</span> <span class="o">..</span> <span class="s2">" "</span> <span class="o">..</span> <span class="n">params</span><span class="p">)</span>
      <span class="k">else</span>
        <span class="n">grub</span><span class="p">.</span><span class="n">run</span> <span class="p">(</span><span class="s2">"linux "</span> <span class="o">..</span> <span class="n">linux</span><span class="p">)</span>
      <span class="k">end</span>
      <span class="n">grub</span><span class="p">.</span><span class="n">run</span> <span class="p">(</span><span class="s2">"initrd "</span> <span class="o">..</span> <span class="n">initrd</span><span class="p">)</span>
    <span class="k">else</span>
      <span class="n">print_error</span> <span class="p">(</span><span class="s2">"Booting Linux failed: cannot find initrd file '"</span> <span class="o">..</span> <span class="n">initrd</span> <span class="o">..</span> <span class="s2">"'"</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">else</span>
    <span class="n">print_error</span> <span class="p">(</span><span class="s2">"Booting Linux failed: cannot find linux file '"</span> <span class="o">..</span> <span class="n">initrd</span> <span class="o">..</span> <span class="s2">"'"</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1">-- Mounts the iso file</span>
<span class="k">function</span> <span class="nf">mount_iso</span> <span class="p">(</span><span class="n">isofile</span><span class="p">)</span>
  <span class="kd">local</span> <span class="n">result</span> <span class="o">=</span> <span class="kc">false</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">isofile</span> <span class="o">==</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
    <span class="n">print_error</span> <span class="p">(</span><span class="s2">"variable 'isofile' is undefined"</span><span class="p">)</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="ow">not</span> <span class="n">grub</span><span class="p">.</span><span class="n">file_exist</span> <span class="p">(</span><span class="n">isofile</span><span class="p">))</span> <span class="k">then</span>
    <span class="n">print_error</span> <span class="p">(</span><span class="s2">"Cannot find isofile '"</span> <span class="o">..</span> <span class="n">isofile</span> <span class="o">..</span> <span class="s2">"'"</span><span class="p">)</span>
  <span class="k">else</span>
    <span class="kd">local</span> <span class="n">err_no</span><span class="p">,</span> <span class="n">err_msg</span> <span class="o">=</span> <span class="n">grub</span><span class="p">.</span><span class="n">run</span> <span class="p">(</span><span class="s2">"loopback loop "</span> <span class="o">..</span> <span class="n">isofile</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">err_no</span> <span class="o">~=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
      <span class="n">print_error</span> <span class="p">(</span><span class="s2">"Cannot load ISO: "</span> <span class="o">..</span> <span class="n">err_msg</span><span class="p">)</span>
    <span class="k">else</span>
      <span class="n">result</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="k">return</span> <span class="n">result</span>
<span class="k">end</span>

<span class="c1">-- Getting the environment parameters</span>
<span class="n">isofile</span> <span class="o">=</span> <span class="n">grub</span><span class="p">.</span><span class="n">getenv</span> <span class="p">(</span><span class="s2">"isofile"</span><span class="p">)</span>
<span class="n">langcode</span> <span class="o">=</span> <span class="n">grub</span><span class="p">.</span><span class="n">getenv</span> <span class="p">(</span><span class="s2">"isolangcode"</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">langcode</span> <span class="o">==</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
  <span class="n">langcode</span> <span class="o">=</span> <span class="s2">"us"</span>
<span class="k">end</span>

<span class="c1">-- Mounting and booting the live system</span>
<span class="k">if</span> <span class="p">(</span><span class="n">mount_iso</span> <span class="p">(</span><span class="n">isofile</span><span class="p">))</span> <span class="k">then</span>
  <span class="n">boot_iso</span> <span class="p">(</span><span class="n">isofile</span><span class="p">,</span> <span class="n">langcode</span><span class="p">)</span>
<span class="k">end</span>
</pre></table></code></div></div><li><p><code class="language-plaintext highlighter-rouge">/mnt/sdb1/boot/grub/listisos.lua</code>:</p><div class="language-lua highlighter-rouge"><div class="code-header"> <span data-label-text="Lua"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="cp">#!lua</span>

<span class="n">isofolder</span> <span class="o">=</span> <span class="n">grub</span><span class="p">.</span><span class="n">getenv</span> <span class="p">(</span><span class="s2">"isofolder"</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">isofolder</span> <span class="o">==</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
  <span class="n">isofolder</span> <span class="o">=</span> <span class="s2">"/isos"</span>
<span class="k">end</span>

<span class="k">function</span> <span class="nf">enum_file</span> <span class="p">(</span><span class="n">name</span><span class="p">)</span>
  <span class="kd">local</span> <span class="n">title</span> <span class="o">=</span> <span class="nb">string.match</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">"(.*)%.[iI][sS][oO]"</span><span class="p">)</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">title</span><span class="p">)</span> <span class="k">then</span>
    <span class="kd">local</span> <span class="n">source</span> <span class="o">=</span> <span class="s2">"set isofile="</span> <span class="o">..</span> <span class="n">isofolder</span> <span class="o">..</span> <span class="s2">"/"</span> <span class="o">..</span> <span class="n">name</span> <span class="o">..</span>
      <span class="s2">"</span><span class="se">\n</span><span class="s2">source /boot/grub/bootiso.lua"</span>

    <span class="n">grub</span><span class="p">.</span><span class="n">add_menu</span> <span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">grub</span><span class="p">.</span><span class="n">enum_file</span> <span class="p">(</span><span class="n">enum_file</span><span class="p">,</span> <span class="n">isofolder</span><span class="p">)</span>
</pre></table></code></div></div></ul><p><strong>UPDATE</strong>: In the new grub versions I had to modify following lines (from <code class="language-plaintext highlighter-rouge">source</code> -&gt; <code class="language-plaintext highlighter-rouge">lua</code> and one module name <code class="language-plaintext highlighter-rouge">vbeinfo</code> -&gt; <code class="language-plaintext highlighter-rouge">vbe</code>) otherwise it was not running correctly. Please look at these lines and change it in the scripts above:</p><div class="language-lua highlighter-rouge"><div class="code-header"> <span data-label-text="Lua"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">insmod</span> <span class="n">vbe</span>

<span class="n">lua</span> <span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">grub</span><span class="o">/</span><span class="n">listisos</span><span class="p">.</span><span class="n">lua</span>

      <span class="s2">"</span><span class="se">\n</span><span class="s2">lua /boot/grub/bootiso.lua"</span>
</pre></table></code></div></div><p>After unmounting your USB flash should be bootable and you should get menu similar to this one:</p><p><a href="/assets/img/posts/2010/2010-03-23-using-grub2-and-lua-installed-on-usb-booting-iso-images/grub_usb.avif" class="popup img-link shimmer"><img src="/assets/img/posts/2010/2010-03-23-using-grub2-and-lua-installed-on-usb-booting-iso-images/grub_usb.avif" alt="GRUB2 USB Boot Menu" loading="lazy"></a></p><p>Enjoy :-)</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/linux/">Linux</a>, <a href="/categories/linux-old-xvx-cz/">linux-old.xvx.cz</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/grub/" class="post-tag no-text-decoration" >grub</a> <a href="/tags/pxe/" class="post-tag no-text-decoration" >pxe</a> <a href="/tags/debian/" class="post-tag no-text-decoration" >debian</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Using%20Grub2%20and%20LUA%20installed%20on%20USB%20booting%20ISO%20images%20-%20Petr's%20Blog&url=https%3A%2F%2Fruzickap.github.io%2Fposts%2Fusing-grub2-and-lua-installed-on-usb-booting-iso-images%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Using%20Grub2%20and%20LUA%20installed%20on%20USB%20booting%20ISO%20images%20-%20Petr's%20Blog&u=https%3A%2F%2Fruzickap.github.io%2Fposts%2Fusing-grub2-and-lua-installed-on-usb-booting-iso-images%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fruzickap.github.io%2Fposts%2Fusing-grub2-and-lua-installed-on-usb-booting-iso-images%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <script defer type="module" src="https://cdn.jsdelivr.net/npm/@justinribeiro/share-to-mastodon/+esm"></script> <button class="btn text-start" data-bs-toggle="tooltip" data-bs-placement="top" title="Mastodon" aria-label="Mastodon"> <share-to-mastodon class="share-mastodon" message="Using%20Grub2%20and%20LUA%20installed%20on%20USB%20booting%20ISO%20images%20-%20Petr's%20Blog" url="https%3A%2F%2Fruzickap.github.io%2Fposts%2Fusing-grub2-and-lua-installed-on-usb-booting-iso-images%2F"customInstanceList="[{&quot;label&quot;:&quot;mastodon.social&quot;,&quot;link&quot;:&quot;https://mastodon.social/&quot;},{&quot;label&quot;:&quot;mastodon.online&quot;,&quot;link&quot;:&quot;https://mastodon.online/&quot;},{&quot;label&quot;:&quot;fosstodon.org&quot;,&quot;link&quot;:&quot;https://fosstodon.org/&quot;},{&quot;label&quot;:&quot;photog.social&quot;,&quot;link&quot;:&quot;https://photog.social/&quot;}]" > <i class="fa-fw fa-brands fa-mastodon"></i> </share-to-mastodon> </button> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/installtion-f5-bigip-virtual-edition-to-rhel7/">Installation F5 BIGIP Virtual Edition to RHEL7</a><li class="text-truncate lh-lg"> <a href="/posts/detect-a-hacker-attacks-eks-vm/">Detect the hacker attacks on Amazon EKS and EC2 instances</a><li class="text-truncate lh-lg"> <a href="/posts/secure-cheap-amazon-eks-auto/">Build secure and cheap Amazon EKS Auto Mode</a><li class="text-truncate lh-lg"> <a href="/posts/eks-auto-cert-manager-velero/">Amazon EKS Auto Mode with cert-manager and Velero</a><li class="text-truncate lh-lg"> <a href="/posts/mcp-servers-k8s/">MCP Servers running on Kubernetes</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/amazon-eks/">amazon-eks</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/cert-manager/">cert-manager</a> <a class="post-tag btn btn-outline-primary" href="/tags/eksctl/">eksctl</a> <a class="post-tag btn btn-outline-primary" href="/tags/bash/">bash</a> <a class="post-tag btn btn-outline-primary" href="/tags/pxe/">pxe</a> <a class="post-tag btn btn-outline-primary" href="/tags/wifi/">wifi</a> <a class="post-tag btn btn-outline-primary" href="/tags/prometheus/">prometheus</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a></div></section></div></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/pxe-server-using-dnsmasq-and-systemrescuecd-with-minimal-effort/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1270936800" data-df="ll" > Apr 11, 2010 </time><h4 class="pt-0 my-2">PXE server using Dnsmasq and SystemRescueCd with minimal effort</h4><div class="text-muted"><p>Set up a minimal PXE boot server using only dnsmasq and a SystemRescueCd ISO image</p></div></div></a></article><article class="col"> <a href="/posts/disable-ipv6-in-debian/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1262041200" data-df="ll" > Dec 29, 2009 </time><h4 class="pt-0 my-2">Disable IPv6 in Debian</h4><div class="text-muted"><p>Disable IPv6 in Debian by adding a GRUB kernel boot parameter</p></div></div></a></article><article class="col"> <a href="/posts/debian-with-grub2-and-serial-connection/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1249423200" data-df="ll" > Aug 5, 2009 </time><h4 class="pt-0 my-2">Debian with GRUB2 and serial connection</h4><div class="text-muted"><p>Configure GRUB2 for serial console output on Debian</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/raid-disk-check-in-linux/" class="btn btn-outline-primary" aria-label="Older" ><p>RAID disk check in Linux</p></a> <a href="/posts/debian-wi-fi-hotspot-using-coovachilli-freeradius-mysql-and-daloradius/" class="btn btn-outline-primary" aria-label="Newer" ><p>Debian Wi-Fi hotspot using CoovaChilli, FreeRadius, MySQL and daloRADIUS</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2026</time> <a href="https://twitter.com/Ruzicka_Petr">Petr Ruzicka</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.4.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/amazon-eks/">amazon-eks</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/cert-manager/">cert-manager</a> <a class="post-tag btn btn-outline-primary" href="/tags/eksctl/">eksctl</a> <a class="post-tag btn btn-outline-primary" href="/tags/bash/">bash</a> <a class="post-tag btn btn-outline-primary" href="/tags/pxe/">pxe</a> <a class="post-tag btn btn-outline-primary" href="/tags/wifi/">wifi</a> <a class="post-tag btn btn-outline-primary" href="/tags/prometheus/">prometheus</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ruzickap/ruzickap.github.io', 'data-repo-id': 'R_kgDOGkp4nQ', 'data-category': 'General', 'data-category-id': 'DIC_kwDOGkp4nc4CSdu1', 'data-mapping': 'pathname', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
