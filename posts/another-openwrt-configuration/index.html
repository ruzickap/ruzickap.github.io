<!doctype html><html lang="en" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Another OpenWrt configuration" /><meta name="author" content="Petr Ruzicka" /><meta property="og:locale" content="en" /><meta name="description" content="Configure OpenWrt with extroot, DDNS, iodine DNS tunneling, nodogsplash captive portal, and collectd monitoring" /><meta property="og:description" content="Configure OpenWrt with extroot, DDNS, iodine DNS tunneling, nodogsplash captive portal, and collectd monitoring" /><link rel="canonical" href="https://ruzickap.github.io/posts/another-openwrt-configuration/" /><meta property="og:url" content="https://ruzickap.github.io/posts/another-openwrt-configuration/" /><meta property="og:site_name" content="Petr’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2012-01-28T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Another OpenWrt configuration" /><meta name="twitter:site" content="@Ruzicka_Petr" /><meta name="twitter:creator" content="@Ruzicka_Petr" /><meta name="google-site-verification" content="4ugGShJoiB9veoPwFcMsMjzk-1BYbi5ozcSnovkBWtA" /><meta name="msvalidate.01" content="592AB158E3F9EF887F8DC8E69A2FF754" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Petr Ruzicka","url":"https://petr.ruzicka.dev"},"dateModified":"2026-02-08T18:16:39+01:00","datePublished":"2012-01-28T00:00:00+01:00","description":"Configure OpenWrt with extroot, DDNS, iodine DNS tunneling, nodogsplash captive portal, and collectd monitoring","headline":"Another OpenWrt configuration","mainEntityOfPage":{"@type":"WebPage","@id":"https://ruzickap.github.io/posts/another-openwrt-configuration/"},"url":"https://ruzickap.github.io/posts/another-openwrt-configuration/"}</script><title>Another OpenWrt configuration | Petr's Blog</title><link rel="icon" type="image/png" href="/assets/img/favicons/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/svg+xml" href="/assets/img/favicons/favicon.svg"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.36.4/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.18/dayjs.min.js,npm/dayjs@1.11.18/locale/en.js,npm/dayjs@1.11.18/plugin/relativeTime.js,npm/dayjs@1.11.18/plugin/localizedFormat.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> document.addEventListener('DOMContentLoaded', () => { const pv = document.getElementById('pageviews'); if (pv !== null) { const uri = location.pathname.replace(/\/$/, ''); const url = `https://ruzickap-github-io.goatcounter.com/counter/${encodeURIComponent(uri)}.json`; fetch(url) .then((response) => response.json()) .then((data) => { const count = data.count.replace(/\D/g, ''); pv.innerText = new Intl.NumberFormat().format(count); }) .catch((error) => { pv.innerText = '1'; }); } }); </script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-64WRCWDZM8"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-64WRCWDZM8'); }); </script> <script async src="https://gc.zgo.at/count.js" data-goatcounter="https://ruzickap-github-io.goatcounter.com/count" ></script> <script defer src="https://cloud.umami.is/script.js" data-website-id="380ea41a-7d5f-4423-8e13-03151bde195f" ></script> <script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token": "ad8c64404e1e41dba184019564cf11bb"}' ></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="https://0.gravatar.com/avatar/5484c0fd9f98e2ffd9212b158931bf4b?s=200" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Petr's Blog</a><p class="site-subtitle fst-italic mb-0">DevOps • GitOps • K8s</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/projects/" class="nav-link"> <i class="fa-fw fas fa-project-diagram"></i> <span>PROJECTS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/ruzickap" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['petr.ruzicka','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://petr.ruzicka.dev" aria-label="homepage" target="_blank" rel="noopener noreferrer" > <i class="fas fa-home"></i> </a> <a href="https://mastodon.social/@petr_ruzicka" aria-label="mastodon" target="_blank" rel="noopener noreferrer me" > <i class="fab fa-mastodon"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Another OpenWrt configuration</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="false"><header><h1 data-toc-skip>Another OpenWrt configuration</h1><p class="post-desc fw-light mb-4">Configure OpenWrt with extroot, DDNS, iodine DNS tunneling, nodogsplash captive portal, and collectd monitoring</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1327705200" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jan 28, 2012 </time> </span> <span> Updated <time data-ts="1770570999" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Feb 8, 2026 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://petr.ruzicka.dev">Petr Ruzicka</a> </em> </span><div> <span> <em id="pageviews"> <i class="fas fa-spinner fa-spin small"></i> </em> views </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1294 words" > <em>7 min</em> read</span></div></div></div></header><div class="content"><blockquote class="prompt-info"><p><a href="https://linux-old.xvx.cz/2012/01/another-openwrt-configuration/">https://linux-old.xvx.cz/2012/01/another-openwrt-configuration/</a></p></blockquote><p>I would like to describe another <a href="https://openwrt.org/">OpenWrt</a> configuration. It’s going to be just a few examples on how to configure the latest available OpenWrt firmware <a href="https://downloads.openwrt.org/backfire/10.03.1/">Backfire 10.03.1</a>.</p><p>I’m going to use <a href="https://www.tp-link.com/en/products/details/?model=TL-WR1043ND">TP-Link TL-WR1043ND</a> wifi router with a small 64MB USB stick <code class="language-plaintext highlighter-rouge">/dev/sda1</code> containing an ext2 partition. I plan to have some stats on the USB stick and simple html pages as well.</p><p>After flashing the original firmware with <a href="https://downloads.openwrt.org/backfire/10.03.1/ar71xx/openwrt-ar71xx-tl-wr1043nd-v1-squashfs-factory.bin">openwrt-ar71xx-tl-wr1043nd-v1-squashfs-factory.bin</a> I installed the kernel related packages and <a href="https://web.archive.org/web/20120203182855/http://wiki.openwrt.org/doc/howto/extroot">extroot</a>:</p><p>(if you have OpenWRT already installed use: <code class="language-plaintext highlighter-rouge">mtd -e firmware -r write /www2/openwrt-ar71xx-tl-wr1043nd-v1-squashfs-sysupgrade.bin firmware</code>)</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
</pre><td class="rouge-code"><pre>telnet 192.168.1.1
passwd

opkg update
opkg <span class="nb">install </span>block-hotplug block-extroot kmod-fs-ext4 kmod-usb-storage

uci <span class="nb">set </span>system.@system[0].hostname<span class="o">=</span>openwrt
uci <span class="nb">set </span>system.@system[0].timezone<span class="o">=</span>CET-1CEST,M3.5.0,M10.5.0/3
uci <span class="nb">set </span>system.@system[0].timezone<span class="o">=</span>CET-1CEST,M3.5.0,M10.5.0/3
uci <span class="nb">set </span>system.@system[0].log_file<span class="o">=</span>/etc/messages
uci <span class="nb">set </span>system.@system[0].log_size<span class="o">=</span>1024
uci <span class="nb">set </span>system.@system[0].log_type<span class="o">=</span>file

uci <span class="nb">set </span>fstab.@mount[0].device<span class="o">=</span>/dev/sda1
uci <span class="nb">set </span>fstab.@mount[0].fstype<span class="o">=</span>ext4
uci <span class="nb">set </span>fstab.@mount[0].options<span class="o">=</span>rw,sync
uci <span class="nb">set </span>fstab.@mount[0].enabled<span class="o">=</span>1
uci <span class="nb">set </span>fstab.@mount[0].enabled_fsck<span class="o">=</span>0
uci <span class="nb">set </span>fstab.@mount[0].is_rootfs<span class="o">=</span>1

uci <span class="nb">set </span>dropbear.@dropbear[0].Port<span class="o">=</span>2222

uci add firewall rule
uci <span class="nb">set </span>firewall.@rule[-1].name<span class="o">=</span>ssh
uci <span class="nb">set </span>firewall.@rule[-1].src<span class="o">=</span>wan
uci <span class="nb">set </span>firewall.@rule[-1].target<span class="o">=</span>ACCEPT
uci <span class="nb">set </span>firewall.@rule[-1].proto<span class="o">=</span>tcp
uci <span class="nb">set </span>firewall.@rule[-1].dest_port<span class="o">=</span>2222

uci add firewall rule
uci <span class="nb">set </span>firewall.@rule[-1].name<span class="o">=</span>iodined
uci <span class="nb">set </span>firewall.@rule[-1].src<span class="o">=</span>wan
uci <span class="nb">set </span>firewall.@rule[-1].target<span class="o">=</span>ACCEPT
uci <span class="nb">set </span>firewall.@rule[-1].proto<span class="o">=</span>udp
uci <span class="nb">set </span>firewall.@rule[-1].dest_port<span class="o">=</span>53

uci add firewall rule
uci <span class="nb">set </span>firewall.@rule[-1].name<span class="o">=</span>snmp
uci <span class="nb">set </span>firewall.@rule[-1].src<span class="o">=</span>wan
uci <span class="nb">set </span>firewall.@rule[-1].target<span class="o">=</span>ACCEPT
uci <span class="nb">set </span>firewall.@rule[-1].proto<span class="o">=</span>udp
uci <span class="nb">set </span>firewall.@rule[-1].dest_port<span class="o">=</span>161

uci add firewall rule
uci <span class="nb">set </span>firewall.@rule[-1].name<span class="o">=</span>http_ser
uci <span class="nb">set </span>firewall.@rule[-1].src<span class="o">=</span>lan
uci <span class="nb">set </span>firewall.@rule[-1].dst<span class="o">=</span>wan
uci <span class="nb">set </span>firewall.@rule[-1].src_ip<span class="o">=</span>192.168.0.0/24
uci <span class="nb">set </span>firewall.@rule[-1].target<span class="o">=</span>ACCEPT
uci <span class="nb">set </span>firewall.@rule[-1].proto<span class="o">=</span>tcp
uci <span class="nb">set </span>firewall.@rule[-1].dest_port<span class="o">=</span>80

uci <span class="nb">set </span>wireless.@wifi-iface[-1].ssid<span class="o">=</span>ser
uci <span class="nb">set </span>wireless.@wifi-iface[-1].encryption<span class="o">=</span>psk2
uci <span class="nb">set </span>wireless.@wifi-iface[-1].key<span class="o">=</span>xxxxxxxx

uci <span class="nb">set </span>wireless.radio0.channel<span class="o">=</span>3
uci <span class="nb">set </span>wireless.radio0.htmode<span class="o">=</span>HT40

uci del wireless.@wifi-device[0].disabled

uci <span class="nb">set </span>network.lan.ipaddr<span class="o">=</span>192.168.0.1

uci <span class="nb">set </span>dhcp.@dnsmasq[0].domain<span class="o">=</span>ser.no-ip.org
uci <span class="nb">set </span>dhcp.@dnsmasq[0].leasefile<span class="o">=</span>/etc/dnsmasq-dhcp.leases
uci <span class="nb">set </span>dhcp.@dnsmasq[0].port<span class="o">=</span>0
uci <span class="nb">set </span>dhcp.@dnsmasq[0].cachelocal<span class="o">=</span>0
uci <span class="nb">set </span>dhcp.lan.dhcp_option<span class="o">=</span>6,8.8.8.8

uci <span class="nb">set </span>dhcp.lan.start<span class="o">=</span>200
uci <span class="nb">set </span>dhcp.lan.limit<span class="o">=</span>254

uci add dhcp host
uci <span class="nb">set </span>dhcp.@host[-1].name<span class="o">=</span>ruz
uci <span class="nb">set </span>dhcp.@host[-1].ip<span class="o">=</span>192.168.0.2
uci <span class="nb">set </span>dhcp.@host[-1].mac<span class="o">=</span>XX:XX:XX:XX:XX:XX
</pre></table></code></div></div><p>Configure the ssh to enable autologin:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>scp <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.ssh/id_rsa.pub"</span> root@192.168.1.1:/tmp/authorized_keys
ssh root@192.168.1.1
<span class="nb">cp</span> /tmp/authorized_keys /etc/dropbear/authorized_keys
<span class="nb">chmod </span>600 /etc/dropbear/authorized_keys
</pre></table></code></div></div><p>Install a few applications:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>opkg update
opkg <span class="nb">install</span> <span class="nt">--force-overwrite</span> htop less openssh-sftp-server tcpdump wget-nossl
</pre></table></code></div></div><p>Configure ssmtp for the outgoing emails:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>opkg <span class="nb">install </span>msmtp-nossl

<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/^\(host\).*/\1 smtp.XXXXXX.cz/'</span> /etc/msmtprc
<span class="nb">cat</span> <span class="o">&gt;&gt;</span> /etc/msmtprc <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh">
auto_from on
maildomain ser.no-ip.org
</span><span class="no">EOF

</span><span class="c"># shellcheck disable=SC2016 # Single quotes intentional - backticks expand on router, not locally</span>
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/^exit 0/i echo -e "Subject: Reboot `uci get system.@system[0].hostname`\\n\\nOpenwrt rebooted: `date`\\n\\n`grep -B 50 \\"syslogd started\\" /etc/messages`" | sendmail petr.ruzicka@gmail.com'</span> /etc/rc.local
</pre></table></code></div></div><p>Configure DDNS:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>opkg <span class="nb">install </span>luci-app-ddns

uci <span class="nb">set </span>ddns.myddns.enabled<span class="o">=</span>1
uci <span class="nb">set </span>ddns.myddns.service_name<span class="o">=</span>no-ip.com
uci <span class="nb">set </span>ddns.myddns.domain<span class="o">=</span>ser.no-ip.org
uci <span class="nb">set </span>ddns.myddns.username<span class="o">=</span>ruz
uci <span class="nb">set </span>ddns.myddns.password<span class="o">=</span>XXXXXXXXXXX
</pre></table></code></div></div><p>Install snmpd:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>opkg <span class="nb">install </span>mini-snmpd

uci <span class="nb">set </span>mini_snmpd.@mini_snmpd[0].interfaces<span class="o">=</span>lo,br-lan,eth0.2,eth0.1
uci <span class="nb">set </span>mini_snmpd.@mini_snmpd[0].community<span class="o">=</span>OpenWrt
uci <span class="nb">set </span>mini_snmpd.@mini_snmpd[0].location<span class="o">=</span><span class="s1">'Ser'</span>
uci <span class="nb">set </span>mini_snmpd.@mini_snmpd[0].contact<span class="o">=</span><span class="s1">'Ser'</span>
uci <span class="nb">set </span>mini_snmpd.@mini_snmpd[0].disks<span class="o">=</span><span class="s1">'/tmp,/overlay'</span>

/etc/init.d/mini_snmpd <span class="nb">enable</span>
</pre></table></code></div></div><p>Configure TFTPboot and dnsmasq script:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="nb">mkdir</span> /tftpboot

wget <span class="nt">-P</span> /tftpboot http://static.netboot.me/gpxe/netbootme.kpxe
uci <span class="nb">set </span>dhcp.@dnsmasq[0].enable_tftp<span class="o">=</span>1
uci <span class="nb">set </span>dhcp.@dnsmasq[0].tftp_root<span class="o">=</span>/tftpboot
uci <span class="nb">set </span>dhcp.@dnsmasq[0].dhcp_boot<span class="o">=</span>netbootme.kpxe

<span class="nb">echo</span> <span class="s2">"dhcp-script=/etc/dnsmasq-script.sh"</span> <span class="o">&gt;&gt;</span> /etc/dnsmasq.conf

<span class="nb">cat</span> <span class="o">&gt;</span> /etc/dnsmasq-script.sh <span class="o">&lt;&lt;</span> <span class="sh">\</span><span class="no">EOF</span><span class="sh">
#!/bin/sh

/bin/echo </span><span class="si">$(</span>/bin/date +<span class="s2">"%F %T"</span><span class="si">)</span><span class="sh"> </span><span class="nv">$*</span><span class="sh"> &gt;&gt; /www2/dnsmasq.script.log

if [ "</span><span class="nv">$1</span><span class="sh">" == "add" ] &amp;&amp; ! grep -iq "</span><span class="nv">$2</span><span class="sh">" /etc/config/dhcp; then
  echo -e "Subject: New MAC on </span><span class="si">$(</span>uci get system.@system[0].hostname<span class="si">)</span><span class="sh">.</span><span class="si">$(</span>uci get dhcp.@dnsmasq[0].domain<span class="si">)</span><span class="se">\\</span><span class="sh">n</span><span class="se">\\</span><span class="sh">n</span><span class="si">$(</span>/bin/date +<span class="s2">"%F %T"</span><span class="si">)</span><span class="sh"> </span><span class="nv">$*</span><span class="sh">" | sendmail petr.ruzicka@gmail.com
fi
</span><span class="no">EOF

</span><span class="nb">chmod </span>a+x /etc/dnsmasq-script.sh
</pre></table></code></div></div><p>Configuration of iodined server (dns-tunelling)</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>opkg <span class="nb">install </span>iodined

uci <span class="nb">set </span>iodined.@iodined[0].address<span class="o">=</span>XX.XXX.XX.XX
uci <span class="nb">set </span>iodined.@iodined[0].password<span class="o">=</span>XXXXXXXX
uci <span class="nb">set </span>iodined.@iodined[0].tunnelip<span class="o">=</span>192.168.99.1
uci <span class="nb">set </span>iodined.@iodined[0].tld<span class="o">=</span>tunnel.XXXXX.cz

/etc/init.d/iodined <span class="nb">enable</span>
</pre></table></code></div></div><p>Configure httpd daemon for the <code class="language-plaintext highlighter-rouge">/www2</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>opkg <span class="nb">install </span>px5g uhttpd-mod-tls

uci del uhttpd.main.listen_http
uci <span class="nb">set </span>uhttpd.px5g.days<span class="o">=</span>3650
uci <span class="nb">set </span>uhttpd.px5g.country<span class="o">=</span>CZ
uci <span class="nb">set </span>uhttpd.px5g.state<span class="o">=</span><span class="s2">"Czech Republic"</span>
uci <span class="nb">set </span>uhttpd.px5g.location<span class="o">=</span>Brno
<span class="nb">rm</span> /etc/uhttpd.crt /etc/uhttpd.key

uci <span class="nb">set </span>uhttpd.main.listen_https<span class="o">=</span><span class="s2">"0.0.0.0:443"</span>

<span class="nb">mkdir</span> <span class="nt">-p</span> /www2/vnstat
uci <span class="nb">set </span>uhttpd.my<span class="o">=</span>uhttpd
uci <span class="nb">set </span>uhttpd.my.listen_http<span class="o">=</span><span class="s2">"0.0.0.0:80"</span>
uci <span class="nb">set </span>uhttpd.my.home<span class="o">=</span>/www2
</pre></table></code></div></div><p>Set the checking time for watchcat for 1 hour:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>opkg <span class="nb">install </span>watchcat

/etc/uci-defaults/50-watchcat
uci <span class="nb">set </span>system.@watchcat[0].period<span class="o">=</span>1h

/etc/init.d/watchcat <span class="nb">enable
</span>uci commit
reboot
</pre></table></code></div></div><p>Repeat the previous steps and continue… You need to repeat it, because your router now reads the configs from “empty” USB stick and not from internal memory. If you remove the USB stick OpenWrt will read the configs from the memory.</p><p>Configure statistics (collectd):</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
</pre><td class="rouge-code"><pre>opkg <span class="nb">install </span>luci-app-statistics

opkg <span class="nb">install </span>collectd-mod-cpu collectd-mod-disk collectd-mod-irq collectd-mod-ping collectd-mod-processes collectd-mod-tcpconns

uci <span class="nb">set </span>luci_statistics.collectd_rrdtool.DataDir<span class="o">=</span>/etc/collectd
uci <span class="nb">set </span>luci_statistics.collectd_ping.enable<span class="o">=</span>1
uci <span class="nb">set </span>luci_statistics.collectd_ping.Hosts<span class="o">=</span>www.google.com
uci <span class="nb">set </span>luci_statistics.collectd_df.enable<span class="o">=</span>1
uci <span class="nb">set </span>luci_statistics.collectd_df.Devices<span class="o">=</span>/dev/sda1
uci <span class="nb">set </span>luci_statistics.collectd_df.MountPoints<span class="o">=</span>/overlay
uci <span class="nb">set </span>luci_statistics.collectd_df.FSTypes<span class="o">=</span>fuseblk
uci <span class="nb">set </span>luci_statistics.collectd_disk.enable<span class="o">=</span>1
uci <span class="nb">set </span>luci_statistics.collectd_disk.Disks<span class="o">=</span>sda
uci <span class="nb">set </span>luci_statistics.collectd_interface.Interfaces<span class="o">=</span><span class="s2">"eth0.2 wlan0 eth0.1"</span>
uci <span class="nb">set </span>luci_statistics.collectd_irq.enable<span class="o">=</span>1
uci <span class="nb">set </span>luci_statistics.collectd_tcpconns.LocalPorts<span class="o">=</span><span class="s2">"2222 80 443"</span>
uci <span class="nb">set </span>luci_statistics.collectd_rrdtool.CacheTimeout<span class="o">=</span>120
uci <span class="nb">set </span>luci_statistics.collectd_rrdtool.CacheFlush<span class="o">=</span>900

/etc/init.d/luci_statistics <span class="nb">enable</span>
/etc/init.d/collectd <span class="nb">enable
</span>opkg <span class="nb">install </span>luci-app-vnstat vnstat vnstati

<span class="nb">mkdir</span> /etc/vnstat
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s@^\(DatabaseDir\).*@\1 "/overlay/etc/vnstat"@'</span> /etc/vnstat.conf
vnstat <span class="nt">-u</span> <span class="nt">-i</span> eth0.2
vnstat <span class="nt">-u</span> <span class="nt">-i</span> wlan0
vnstat <span class="nt">-u</span> <span class="nt">-i</span> eth0.1
/etc/init.d/vnstat <span class="nb">enable</span>
/etc/init.d/vnstat start
<span class="nb">echo</span> <span class="s2">"*/5 * * * * vnstat -u"</span> <span class="o">&gt;&gt;</span> /etc/crontabs/root

<span class="nb">cat</span> <span class="o">&gt;</span> /etc/graphs-vnstat.sh <span class="o">&lt;&lt;</span> <span class="sh">\</span><span class="no">EOF</span><span class="sh">
#!/bin/sh
# vnstati image generation script.
# Source: http://code.google.com/p/x-wrt/source/browse/trunk/package/webif/files/www/cgi-bin/webif/graphs-vnstat.sh

WWW_D=/www2/vnstat # output images to here
LIB_D=</span><span class="si">$(</span><span class="nb">awk</span> <span class="nt">-F</span> <span class="se">\"</span> <span class="s1">'/^DatabaseDir/ { print $2 }'</span> /etc/vnstat.conf<span class="si">)</span><span class="sh"> # db location
BIN=/usr/bin/vnstati  # which vnstati

outputs="s h d t m"   # what images to generate

# Sanity checks
[ -d "</span><span class="nv">$WWW_D</span><span class="sh">" ] || mkdir -p "</span><span class="nv">$WWW_D</span><span class="sh">" # make the folder if it doesn't exist.

# End of config changes
interfaces="</span><span class="si">$(</span><span class="nb">ls</span> <span class="nt">-1</span> <span class="nv">$LIB_D</span><span class="si">)</span><span class="sh">"

if [ -z "</span><span class="nv">$interfaces</span><span class="sh">" ]; then
    echo "No database found, nothing to do."
    echo "A new database can be created with the following command: "
    echo "    vnstat -u -i eth0"
    exit 0
else
    for interface in </span><span class="nv">$interfaces</span><span class="sh">; do
        for output in </span><span class="nv">$outputs</span><span class="sh">; do
            </span><span class="nv">$BIN</span><span class="sh"> -</span><span class="k">${</span><span class="nv">output</span><span class="k">}</span><span class="sh"> -i </span><span class="nv">$interface</span><span class="sh"> -o </span><span class="nv">$WWW_D</span><span class="sh">/vnstat_</span><span class="k">${</span><span class="nv">interface</span><span class="k">}</span><span class="sh">_</span><span class="k">${</span><span class="nv">output</span><span class="k">}</span><span class="sh">.png
        done
    done
fi

exit 1
</span><span class="no">EOF

</span><span class="nb">chmod </span>a+x /etc/graphs-vnstat.sh
<span class="nb">echo</span> <span class="s2">"*/31 * * * * /etc/graphs-vnstat.sh"</span> <span class="o">&gt;&gt;</span> /etc/crontabs/root

<span class="nb">cat</span> <span class="o">&gt;</span> /www2/vnstat/index.html <span class="o">&lt;&lt;</span> <span class="sh">\</span><span class="no">EOF</span><span class="sh">
&lt;META HTTP-EQUIV="refresh" CONTENT="300"&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Traffic of OpenWRT interfaces&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
</span><span class="no">EOF

</span><span class="k">for </span>IFCE <span class="k">in</span> <span class="s2">"</span><span class="si">$(</span><span class="nb">awk</span> <span class="nt">-F</span> <span class="se">\"</span> <span class="s1">'/^DatabaseDir/ { print $2 }'</span> /etc/vnstat.conf<span class="si">)</span><span class="s2">"</span>/<span class="k">*</span><span class="p">;</span> <span class="k">do
  </span><span class="nb">cat</span> <span class="o">&gt;&gt;</span> /www2/vnstat/index.html <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh">
    &lt;h3&gt;Traffic of Interface </span><span class="nv">$IFCE</span><span class="sh">&lt;/h3&gt;
    &lt;table&gt;
        &lt;tbody&gt;
            &lt;tr&gt;
                &lt;td&gt;
                    &lt;img src="vnstat_</span><span class="k">${</span><span class="nv">IFCE</span><span class="k">}</span><span class="sh">_s.png" alt="</span><span class="nv">$IFCE</span><span class="sh"> Summary" /&gt;
                &lt;/td&gt;
                &lt;td&gt;
                    &lt;img src="vnstat_</span><span class="k">${</span><span class="nv">IFCE</span><span class="k">}</span><span class="sh">_h.png" alt="</span><span class="nv">$IFCE</span><span class="sh"> Hourly" /&gt;
                &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td valign="top"&gt;
                    &lt;img src="vnstat_</span><span class="k">${</span><span class="nv">IFCE</span><span class="k">}</span><span class="sh">_d.png" alt="</span><span class="nv">$IFCE</span><span class="sh"> Daily" /&gt;
                &lt;/td&gt;
                &lt;td valign="top"&gt;
                    &lt;img src="vnstat_</span><span class="k">${</span><span class="nv">IFCE</span><span class="k">}</span><span class="sh">_t.png" alt="</span><span class="nv">$IFCE</span><span class="sh"> Top 10" /&gt;

                    &lt;img src="vnstat_</span><span class="k">${</span><span class="nv">IFCE</span><span class="k">}</span><span class="sh">_m.png" alt="</span><span class="nv">$IFCE</span><span class="sh"> Monthly" /&gt;
                &lt;/td&gt;
            &lt;/tr&gt;
        &lt;/tbody&gt;
    &lt;/table&gt;
</span><span class="no">EOF
</span><span class="k">done

</span><span class="nb">cat</span> <span class="o">&gt;&gt;</span> /www2/vnstat/index.html <span class="o">&lt;&lt;</span> <span class="sh">\</span><span class="no">EOF</span><span class="sh">
  &lt;/body&gt;
&lt;/html&gt;
</span><span class="no">EOF
</span></pre></table></code></div></div><p>Configure the nodogsplash:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>opkg <span class="nb">install </span>nodogsplash

<span class="nb">cp </span>nodogsplash.conf nodogsplash.conf-orig
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s/</span><span class="se">\(</span><span class="s2">^GatewayInterface</span><span class="se">\)</span><span class="s2">.*/</span><span class="se">\1</span><span class="s2"> br-lan/;s/^# </span><span class="se">\(</span><span class="s2">GatewayName</span><span class="se">\)</span><span class="s2">.*/</span><span class="se">\1</span><span class="s2"> Ser/;s/</span><span class="se">\(</span><span class="s2">.*FirewallRule allow tcp port 80</span><span class="se">\)</span><span class="nv">$/</span><span class="s2">#</span><span class="se">\1</span><span class="s2">/;s@^# </span><span class="se">\(</span><span class="s2">GatewayIPRange</span><span class="se">\)</span><span class="s2">.*@</span><span class="se">\1</span><span class="s2"> 192.168.0.192/26@;/FirewallRule block to 10.0.0.0</span><span class="se">\/</span><span class="s2">8/a</span><span class="se">\ \ \ \ </span><span class="s2">FirewallRule allow tcp port 80"</span> /etc/nodogsplash/nodogsplash.conf

<span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"/&lt;td align=center height=</span><span class="se">\"</span><span class="s2">120</span><span class="se">\"</span><span class="s2">&gt;/a</span><span class="se">\</span><span class="s2">
&lt;h3&gt;For Internet access - click the dog&lt;/h3&gt;</span><span class="se">\</span><span class="s2">
&lt;h3&gt;Pro pristup na Internet klikni na psa.&lt;/h3&gt;</span><span class="se">\</span><span class="s2">
"</span> /etc/nodogsplash/htdocs/splash.html

/etc/init.d/nodogsplash <span class="nb">enable

</span>uci commit
reboot
</pre></table></code></div></div><p>That’s all… ;-) Happy OpenWRTing…</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/openwrt/">OpenWrt</a>, <a href="/categories/networking/">Networking</a>, <a href="/categories/linux-old-xvx-cz/">linux-old.xvx.cz</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/tp-link/" class="post-tag no-text-decoration" >tp-link</a> <a href="/tags/wifi/" class="post-tag no-text-decoration" >wifi</a> <a href="/tags/pxe/" class="post-tag no-text-decoration" >pxe</a> <a href="/tags/dnsmasq/" class="post-tag no-text-decoration" >dnsmasq</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Another%20OpenWrt%20configuration%20-%20Petr's%20Blog&url=https%3A%2F%2Fruzickap.github.io%2Fposts%2Fanother-openwrt-configuration%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Another%20OpenWrt%20configuration%20-%20Petr's%20Blog&u=https%3A%2F%2Fruzickap.github.io%2Fposts%2Fanother-openwrt-configuration%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fruzickap.github.io%2Fposts%2Fanother-openwrt-configuration%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <script defer type="module" src="https://cdn.jsdelivr.net/npm/@justinribeiro/share-to-mastodon/+esm"></script> <button class="btn text-start" data-bs-toggle="tooltip" data-bs-placement="top" title="Mastodon" aria-label="Mastodon"> <share-to-mastodon class="share-mastodon" message="Another%20OpenWrt%20configuration%20-%20Petr's%20Blog" url="https%3A%2F%2Fruzickap.github.io%2Fposts%2Fanother-openwrt-configuration%2F"customInstanceList="[{&quot;label&quot;:&quot;mastodon.social&quot;,&quot;link&quot;:&quot;https://mastodon.social/&quot;},{&quot;label&quot;:&quot;mastodon.online&quot;,&quot;link&quot;:&quot;https://mastodon.online/&quot;},{&quot;label&quot;:&quot;fosstodon.org&quot;,&quot;link&quot;:&quot;https://fosstodon.org/&quot;},{&quot;label&quot;:&quot;photog.social&quot;,&quot;link&quot;:&quot;https://photog.social/&quot;}]" > <i class="fa-fw fa-brands fa-mastodon"></i> </share-to-mastodon> </button> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/installtion-f5-bigip-virtual-edition-to-rhel7/">Installation F5 BIGIP Virtual Edition to RHEL7</a><li class="text-truncate lh-lg"> <a href="/posts/detect-a-hacker-attacks-eks-vm/">Detect the hacker attacks on Amazon EKS and EC2 instances</a><li class="text-truncate lh-lg"> <a href="/posts/secure-cheap-amazon-eks-auto/">Build secure and cheap Amazon EKS Auto Mode</a><li class="text-truncate lh-lg"> <a href="/posts/eks-auto-cert-manager-velero/">Amazon EKS Auto Mode with cert-manager and Velero</a><li class="text-truncate lh-lg"> <a href="/posts/mcp-servers-k8s/">MCP Servers running on Kubernetes</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/amazon-eks/">amazon-eks</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/cert-manager/">cert-manager</a> <a class="post-tag btn btn-outline-primary" href="/tags/eksctl/">eksctl</a> <a class="post-tag btn btn-outline-primary" href="/tags/bash/">bash</a> <a class="post-tag btn btn-outline-primary" href="/tags/pxe/">pxe</a> <a class="post-tag btn btn-outline-primary" href="/tags/wifi/">wifi</a> <a class="post-tag btn btn-outline-primary" href="/tags/prometheus/">prometheus</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a></div></section></div></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/openwrt-backfire-1003-and-tl-wr1043nd/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1323730800" data-df="ll" > Dec 13, 2011 </time><h4 class="pt-0 my-2">OpenWrt (Backfire 10.03) and TL-WR1043ND</h4><div class="text-muted"><p>Configure OpenWrt Backfire on TP-Link TL-WR1043ND with USB extroot, dual WiFi, webcam, and temperature sensors</p></div></div></a></article><article class="col"> <a href="/posts/tp-link-tl-wr1043nd-and-openwrt-1209-with-two-ssids-multissid-private-and-guest/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1375480800" data-df="ll" > Aug 3, 2013 </time><h4 class="pt-0 my-2">TP-Link TL-WR1043ND and OpenWrt 12.09 with two SSIDs (MultiSSID) - private and guest</h4><div class="text-muted"><p>TP-Link TL-WR1043ND and OpenWrt 12.09 with two SSIDs (MultiSSID) - private and guest</p></div></div></a></article><article class="col"> <a href="/posts/pxe-server-using-dnsmasq-and-systemrescuecd-with-minimal-effort/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1270936800" data-df="ll" > Apr 11, 2010 </time><h4 class="pt-0 my-2">PXE server using Dnsmasq and SystemRescueCd with minimal effort</h4><div class="text-muted"><p>Set up a minimal PXE boot server using only dnsmasq and a SystemRescueCd ISO image</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/openwrt-backfire-1003-and-tl-wr1043nd/" class="btn btn-outline-primary" aria-label="Older" ><p>OpenWrt (Backfire 10.03) and TL-WR1043ND</p></a> <a href="/posts/notes-about-upgrade-from-cyanogenmod-70-to-72/" class="btn btn-outline-primary" aria-label="Newer" ><p>Notes about upgrade from CyanogenMod 7.0 to 7.2</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2026</time> <a href="https://twitter.com/Ruzicka_Petr">Petr Ruzicka</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.4.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/amazon-eks/">amazon-eks</a> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/cert-manager/">cert-manager</a> <a class="post-tag btn btn-outline-primary" href="/tags/eksctl/">eksctl</a> <a class="post-tag btn btn-outline-primary" href="/tags/bash/">bash</a> <a class="post-tag btn btn-outline-primary" href="/tags/pxe/">pxe</a> <a class="post-tag btn btn-outline-primary" href="/tags/wifi/">wifi</a> <a class="post-tag btn btn-outline-primary" href="/tags/prometheus/">prometheus</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ruzickap/ruzickap.github.io', 'data-repo-id': 'R_kgDOGkp4nQ', 'data-category': 'General', 'data-category-id': 'DIC_kwDOGkp4nc4CSdu1', 'data-mapping': 'pathname', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
